---

title: Read and Write TFRecord


keywords: fastai
sidebar: home_sidebar



nb_path: "source_nbs/06_read_write_tfrecord.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: source_nbs/06_read_write_tfrecord.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-1&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="serialize_fn" class="doc_header"><code>serialize_fn</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>serialize_fn</code>(<strong><code>features</code></strong>:<code>dict</code>, <strong><code>return_feature_desc</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_tfrecord" class="doc_header"><code>make_tfrecord</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L124" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_tfrecord</code>(<strong><code>data_list</code></strong>, <strong><code>output_dir</code></strong>, <strong><code>serialize_fn</code></strong>, <strong><code>mode</code></strong>=<em><code>'train'</code></em>, <strong><code>shards_per_file</code></strong>=<em><code>100000</code></em>, <strong><code>prefix</code></strong>=<em><code>''</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_feature_desc" class="doc_header"><code>make_feature_desc</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L164" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_feature_desc</code>(<strong><code>feature_desc_dict</code></strong>:<code>dict</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="write_single_problem_chunk_tfrecord" class="doc_header"><code>write_single_problem_chunk_tfrecord</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L174" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>write_single_problem_chunk_tfrecord</code>(<strong><code>problem</code></strong>, <strong><code>inputs_list</code></strong>, <strong><code>target_list</code></strong>, <strong><code>label_encoder</code></strong>, <strong><code>params</code></strong>, <strong><code>tokenizer</code></strong>, <strong><code>mode</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="write_single_problem_gen_tfrecord" class="doc_header"><code>write_single_problem_gen_tfrecord</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L275" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>write_single_problem_gen_tfrecord</code>(<strong><code>problem</code></strong>, <strong><code>gen</code></strong>, <strong><code>label_encoder</code></strong>, <strong><code>params</code></strong>, <strong><code>tokenizer</code></strong>, <strong><code>mode</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="write_tfrecord" class="doc_header"><code>write_tfrecord</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L362" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>write_tfrecord</code>(<strong><code>params</code></strong>, <strong><code>replace</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Write TFRecord for every problem chunk</p>
<p>Output location: params.tmp_file_dir</p>
<p>Arguments:
    params {params} -- params</p>
<p>Keyword Arguments:
    replace {bool} -- Whether to replace existing tfrecord (default: {False})</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered celltag_outputPrepend">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_base</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assign_problem</span><span class="p">(</span>
    <span class="s1">&#39;weibo_fake_ner&amp;weibo_fake_cls|weibo_fake_multi_cls|weibo_masklm&#39;</span><span class="p">)</span>
<span class="n">write_tfrecord</span><span class="p">(</span>
    <span class="n">params</span><span class="o">=</span><span class="n">test_base</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">test_base</span><span class="o">.</span><span class="n">tmpfiledir</span><span class="p">,</span> <span class="s1">&#39;weibo_fake_cls_weibo_fake_ner&#39;</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">test_base</span><span class="o">.</span><span class="n">tmpfiledir</span><span class="p">,</span> <span class="s1">&#39;weibo_fake_multi_cls&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> [&#39;延&#39;, &#39;参&#39;, &#39;法&#39;, &#39;师&#39;, &#39;品&#39;, &#39;味&#39;, &#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;同&#39;, &#39;走&#39;, &#39;进&#39;, &#39;一&#39;, &#39;片&#39;, &#39;山&#39;, &#39;水&#39;, &#39;，&#39;, &#39;静&#39;, &#39;静&#39;, &#39;的&#39;, &#39;呼&#39;, &#39;吸&#39;, &#39;，&#39;, &#39;安&#39;, &#39;静&#39;, &#39;的&#39;, &#39;欣&#39;, &#39;赏&#39;, &#39;，&#39;, &#39;这&#39;, &#39;就&#39;, &#39;是&#39;, &#39;生&#39;, &#39;活&#39;, &#39;。&#39;]
INFO:tensorflow:image: [[0.96189013 0.26058124 0.59112081 0.67201715 0.05187993 0.99840871
  0.17283583 0.98589714 0.90298959 0.87447827]
 [0.44340665 0.08280935 0.00933452 0.564422   0.53071306 0.63621486
  0.20898997 0.84
INFO:tensorflow:input_ids: [101, 2454, 1346, 3791, 2360, 1501, 1456, 782, 4495, 1963, 1398, 6624, 6822, 671, 4275, 2255, 3717, 8024, 7474, 7474, 4638, 1461, 1429, 8024, 2128, 7474, 4638, 3615, 6605, 8024, 6821, 2218, 3221, 4495
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:image_input: [[0.96189013 0.26058124 0.59112081 0.67201715 0.05187993 0.99840871
  0.17283583 0.98589714 0.90298959 0.87447827]
 [0.44340665 0.08280935 0.00933452 0.564422   0.53071306 0.63621486
  0.20898997 0.84
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:[&#39;对&#39;, &#39;，&#39;, &#39;输&#39;, &#39;给&#39;, &#39;一&#39;, &#39;个&#39;, &#39;女&#39;, &#39;人&#39;, &#39;，&#39;, &#39;的&#39;, &#39;成&#39;, &#39;绩&#39;, &#39;。&#39;, &#39;失&#39;, &#39;望&#39;]
INFO:tensorflow:input_ids: [101, 2190, 8024, 6783, 5314, 103, 702, 1957, 782, 8024, 4638, 2768, 5327, 511, 1927, 3307, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [671   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   0   0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;今&#39;, &#39;天&#39;, &#39;下&#39;, &#39;午&#39;, &#39;起&#39;, &#39;来&#39;, &#39;看&#39;, &#39;到&#39;, &#39;外&#39;, &#39;面&#39;, &#39;的&#39;, &#39;太&#39;, &#39;阳&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;我&#39;, &#39;第&#39;, &#39;一&#39;, &#39;反&#39;, &#39;应&#39;, &#39;竟&#39;, &#39;然&#39;, &#39;是&#39;, &#39;强&#39;, &#39;烈&#39;, &#39;的&#39;, &#39;想&#39;, &#39;回&#39;, &#39;家&#39;, &#39;泪&#39;, &#39;想&#39;, &#39;我&#39;, &#39;们&#39;, &#39;一&#39;, &#39;起&#39;, &#39;在&#39;, &#39;嘉&#39;, &#39;鱼&#39;,
INFO:tensorflow:input_ids: [101, 791, 1921, 678, 1286, 6629, 3341, 4692, 1168, 1912, 7481, 4638, 1922, 7345, 511, 511, 511, 511, 103, 5018, 671, 1353, 2418, 4994, 103, 3221, 2487, 103, 4638, 2682, 1726, 2157, 103, 2682, 103, 81
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [18, 24, 27, 32, 34, 36, 38, 40, 47, 50, 62, 66, 73, 77, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [2769 4197 4164 3801 2769  671 1762 7824  511 1962 1127 4607 2682 3321
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0]
INFO:tensorflow:[&#39;今&#39;, &#39;年&#39;, &#39;拜&#39;, &#39;年&#39;, &#39;不&#39;, &#39;短&#39;, &#39;信&#39;, &#39;，&#39;, &#39;就&#39;, &#39;在&#39;, &#39;微&#39;, &#39;博&#39;, &#39;拜&#39;, &#39;大&#39;, &#39;年&#39;, &#39;寻&#39;, &#39;龙&#39;, &#39;记&#39;]
INFO:tensorflow:input_ids: [101, 791, 2399, 2876, 2399, 679, 4764, 928, 103, 2218, 1762, 103, 103, 2876, 1920, 2399, 2192, 7987, 6381, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [8, 11, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [8024 2544 1300    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;浑&#39;, &#39;身&#39;, &#39;酸&#39;, &#39;疼&#39;, &#39;，&#39;, &#39;两&#39;, &#39;腿&#39;, &#39;无&#39;, &#39;力&#39;, &#39;，&#39;, &#39;眼&#39;, &#39;神&#39;, &#39;呆&#39;, &#39;滞&#39;, &#39;，&#39;, &#39;怎&#39;, &#39;么&#39;, &#39;了&#39;]
INFO:tensorflow:input_ids: [101, 3847, 103, 7000, 4563, 8024, 103, 5597, 103, 1213, 8024, 4706, 4868, 1438, 103, 8024, 2582, 720, 749, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [2, 6, 8, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [6716  697 3187 4005    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;明&#39;, &#39;显&#39;, &#39;紧&#39;, &#39;张&#39;, &#39;状&#39;, &#39;态&#39;, &#39;没&#39;, &#39;出&#39;, &#39;来&#39;, &#39;，&#39;, &#39;失&#39;, &#39;误&#39;, &#39;多&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 3209, 3227, 5165, 103, 4307, 2578, 3766, 1139, 3341, 103, 1927, 6428, 1914, 103, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [4, 10, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [2476 8024  511    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;三&#39;, &#39;十&#39;, &#39;年&#39;, &#39;前&#39;, &#39;，&#39;, &#39;老&#39;, &#39;爹&#39;, &#39;带&#39;, &#39;我&#39;, &#39;来&#39;, &#39;这&#39;, &#39;里&#39;, &#39;开&#39;, &#39;会&#39;, &#39;，&#39;, &#39;今&#39;, &#39;天&#39;, &#39;打&#39;, &#39;了&#39;, &#39;个&#39;, &#39;颠&#39;, &#39;倒&#39;, &#39;。&#39;, &#39;我&#39;, &#39;在&#39;, &#39;这&#39;, &#39;里&#39;]
INFO:tensorflow:input_ids: [101, 676, 103, 2399, 103, 8024, 103, 103, 2372, 2769, 103, 6821, 7027, 2458, 103, 8024, 103, 1921, 103, 749, 702, 7585, 948, 511, 2769, 1762, 103, 7027, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [2, 4, 6, 7, 10, 14, 16, 18, 26, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1282 1184 5439 4269 3341  833  791 2802 6821    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;好&#39;, &#39;活&#39;, &#39;动&#39;, &#39;呀&#39;, &#39;，&#39;, &#39;给&#39;, &#39;力&#39;, &#39;的&#39;, &#39;商&#39;, &#39;家&#39;, &#39;，&#39;, &#39;必&#39;, &#39;须&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;希&#39;, &#39;望&#39;, &#39;以&#39;, &#39;后&#39;, &#39;多&#39;, &#39;多&#39;, &#39;办&#39;, &#39;活&#39;, &#39;动&#39;, &#39;跟&#39;, &#39;我&#39;, &#39;们&#39;, &#39;互&#39;, &#39;动&#39;, &#39;哈&#39;, &#39;巧&#39;, &#39;慧&#39;, &#39;铣&#39;]
INFO:tensorflow:input_ids: [101, 1962, 3833, 1220, 103, 103, 103, 1213, 4638, 1555, 2157, 8024, 103, 7557, 3118, 2898, 8024, 2361, 103, 809, 1400, 1914, 1914, 1215, 3833, 1220, 6656, 2769, 103, 757, 1220, 1506, 2341, 2716, 103,
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [4, 5, 6, 12, 18, 28, 34, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1435 8024 5314 2553 3307  812 7203    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;戏&#39;, &#39;，&#39;, &#39;导&#39;, &#39;演&#39;, &#39;是&#39;, &#39;自&#39;, &#39;己&#39;, &#39;蜡&#39;, &#39;烛&#39;]
INFO:tensorflow:input_ids: [101, 103, 4495, 1963, 2767, 103, 2193, 4028, 3221, 5632, 2346, 6058, 4169, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [1, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [ 782 8024    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;听&#39;, &#39;说&#39;, &#39;小&#39;, &#39;米&#39;, &#39;开&#39;, &#39;卖&#39;, &#39;了&#39;, &#39;，&#39;, &#39;刚&#39;, &#39;刚&#39;, &#39;预&#39;, &#39;约&#39;, &#39;了&#39;, &#39;台&#39;, &#39;。&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;因&#39;, &#39;为&#39;, &#39;他&#39;, &#39;是&#39;, &#39;迄&#39;, &#39;今&#39;, &#39;为&#39;, &#39;止&#39;, &#39;最&#39;, &#39;快&#39;, &#39;的&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;月&#39;, &#39;日&#39;, &#39;中&#39;, &#39;午&#39;,
INFO:tensorflow:input_ids: [101, 103, 6432, 2207, 5101, 2458, 1297, 749, 8024, 103, 1157, 7564, 5276, 749, 1378, 511, 2769, 103, 2207, 5101, 2797, 3322, 1728, 711, 800, 3221, 6812, 791, 103, 3632, 3297, 2571, 4638, 2207, 5101, 
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [1, 9, 17, 28, 36, 39, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1420 1157 4263  711 3322  704 1770    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;最&#39;, &#39;热&#39;, &#39;时&#39;, &#39;尚&#39;, &#39;榜&#39;, &#39;女&#39;, &#39;人&#39;, &#39;不&#39;, &#39;坏&#39;, &#39;，&#39;, &#39;男&#39;, &#39;人&#39;, &#39;不&#39;, &#39;爱&#39;, &#39;，&#39;, &#39;一&#39;, &#39;个&#39;, &#39;男&#39;, &#39;女&#39;, &#39;必&#39;, &#39;看&#39;, &#39;的&#39;, &#39;微&#39;, &#39;博&#39;, &#39;花&#39;, &#39;心&#39;]
INFO:tensorflow:input_ids: [101, 3297, 103, 3198, 2213, 3528, 1957, 782, 103, 1776, 8024, 4511, 782, 679, 4263, 8024, 671, 702, 103, 1957, 2553, 4692, 4638, 2544, 1300, 5709, 103, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [2, 8, 18, 26, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [4178  679 4511 2552    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;回&#39;, &#39;复&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;赞&#39;, &#39;成&#39;, &#39;，&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;米&#39;, &#39;八&#39;, &#39;吴&#39;, &#39;够&#39;, &#39;历&#39;, &#39;史&#39;, &#39;要&#39;, &#39;的&#39;, &#39;陈&#39;, &#39;小&#39;, &#39;奥&#39;, &#39;丁&#39;, &#39;丁&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;肥&#39;, &#39;肥&#39;, &#39;一&#39;, &#39;族&#39;, &#39;大&#39;, &#39;头&#39;, &#39;仔&#39;, &#39;大&#39;, &#39;家&#39;, &#39;团&#39;, &#39;结&#39;, &#39;一&#39;, &#39;致&#39;, &#39;，&#39;,
INFO:tensorflow:input_ids: [101, 1726, 1908, 3118, 2898, 103, 6614, 2768, 8024, 103, 1506, 5101, 1061, 103, 1916, 1325, 1380, 6206, 4638, 7357, 2207, 103, 672, 672, 2769, 4263, 2207, 5503, 5503, 671, 3184, 1920, 103, 798, 1920,
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [5, 9, 13, 21, 32, 36, 37, 40, 44, 47, 55, 57, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [8024 1506 1426 1952 1928 1730 5310 8024 1378 1599 5310 1213    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;剑&#39;, &#39;网&#39;, &#39;乱&#39;, &#39;世&#39;, &#39;长&#39;, &#39;安&#39;, &#39;公&#39;, &#39;测&#39;, &#39;盛&#39;, &#39;典&#39;, &#39;今&#39;, &#39;日&#39;, &#39;开&#39;, &#39;启&#39;, &#39;，&#39;, &#39;海&#39;, &#39;量&#39;, &#39;豪&#39;, &#39;礼&#39;, &#39;火&#39;, &#39;爆&#39;, &#39;开&#39;, &#39;送&#39;, &#39;精&#39;, &#39;美&#39;, &#39;挂&#39;, &#39;件&#39;, &#39;、&#39;, &#39;听&#39;, &#39;雨&#39;, &#39;·&#39;, &#39;汉&#39;, &#39;服&#39;, &#39;娃&#39;, &#39;娃&#39;, &#39;、&#39;, &#39;诙&#39;, &#39;谐&#39;, &#39;双&#39;, &#39;骑&#39;,
INFO:tensorflow:input_ids: [101, 1187, 5381, 744, 686, 7270, 103, 1062, 3844, 4670, 1073, 103, 3189, 103, 1423, 8024, 3862, 7030, 6498, 103, 4125, 4255, 2458, 6843, 5125, 5401, 2899, 103, 510, 1420, 7433, 185, 103, 3302, 103, 1
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [6, 11, 13, 19, 27, 32, 34, 35, 36, 45, 47, 52, 58, 61, 62, 70, 80, 86, 87, 0]
INFO:tensorflow:masked_lm_ids: [2128  791 2458 4851  816 3727 2015 2015  510  872 2897 1378 5023 7028
 2661 1765 2135 2145 2787    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0]
INFO:tensorflow:[&#39;在&#39;, &#39;街&#39;, &#39;上&#39;, &#39;听&#39;, &#39;见&#39;, &#39;音&#39;, &#39;乐&#39;, &#39;我&#39;, &#39;舞&#39;, &#39;动&#39;, &#39;起&#39;, &#39;来&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;？&#39;, &#39;真&#39;, &#39;的&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;吗&#39;, &#39;？&#39;]
INFO:tensorflow:input_ids: [101, 1762, 6125, 677, 1420, 6224, 7509, 727, 2769, 5659, 1220, 6629, 103, 2523, 696, 782, 8043, 4696, 4638, 2523, 696, 782, 1408, 8043, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [3341    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;三&#39;, &#39;毛&#39;, &#39;说&#39;, &#39;我&#39;, &#39;唯&#39;, &#39;一&#39;, &#39;锲&#39;, &#39;而&#39;, &#39;不&#39;, &#39;舍&#39;, &#39;，&#39;, &#39;愿&#39;, &#39;意&#39;, &#39;以&#39;, &#39;自&#39;, &#39;己&#39;, &#39;的&#39;, &#39;生&#39;, &#39;命&#39;, &#39;去&#39;, &#39;努&#39;, &#39;力&#39;, &#39;的&#39;, &#39;，&#39;, &#39;只&#39;, &#39;不&#39;, &#39;过&#39;, &#39;是&#39;, &#39;保&#39;, &#39;守&#39;, &#39;我&#39;, &#39;个&#39;, &#39;人&#39;, &#39;的&#39;, &#39;心&#39;, &#39;怀&#39;, &#39;意&#39;, &#39;念&#39;, &#39;，&#39;, &#39;在&#39;,
INFO:tensorflow:input_ids: [101, 676, 3688, 103, 103, 1546, 671, 7244, 5445, 679, 5650, 8024, 2703, 2692, 809, 5632, 2346, 4638, 4495, 1462, 1343, 1222, 103, 4638, 8024, 1372, 679, 6814, 3221, 924, 2127, 2769, 103, 782, 4638, 2
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [3, 4, 22, 32, 47, 49, 50, 53, 64, 69, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [6432 2769 1213  702  976  702 4696  782 1469 3300    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;星&#39;, &#39;期&#39;, &#39;天&#39;, &#39;的&#39;, &#39;早&#39;, &#39;晨&#39;, &#39;七&#39;, &#39;点&#39;, &#39;学&#39;, &#39;车&#39;, &#39;，&#39;, &#39;驾&#39;, &#39;校&#39;, &#39;太&#39;, &#39;给&#39;, &#39;力&#39;, &#39;。&#39;, &#39;我&#39;, &#39;的&#39;, &#39;头&#39;, &#39;发&#39;, &#39;都&#39;, &#39;没&#39;, &#39;有&#39;, &#39;洗&#39;]
INFO:tensorflow:input_ids: [101, 3215, 3309, 1921, 103, 3193, 3247, 673, 4157, 2110, 6756, 8024, 7730, 3413, 1922, 5314, 103, 103, 2769, 4638, 1928, 1355, 6963, 3766, 3300, 3819, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [4, 16, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [4638 1213  511    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;发&#39;, &#39;表&#39;, &#39;了&#39;, &#39;博&#39;, &#39;文&#39;, &#39;小&#39;, &#39;学&#39;, &#39;美&#39;, &#39;术&#39;, &#39;新&#39;, &#39;课&#39;, &#39;标&#39;, &#39;的&#39;, &#39;反&#39;, &#39;思&#39;, &#39;学&#39;, &#39;习&#39;, &#39;新&#39;, &#39;学&#39;, &#39;期&#39;, &#39;开&#39;, &#39;学&#39;, &#39;有&#39;, &#39;两&#39;, &#39;个&#39;, &#39;多&#39;, &#39;月&#39;, &#39;了&#39;, &#39;，&#39;, &#39;在&#39;, &#39;这&#39;, &#39;段&#39;, &#39;时&#39;, &#39;间&#39;, &#39;的&#39;, &#39;教&#39;, &#39;学&#39;, &#39;计&#39;, &#39;划&#39;, &#39;、&#39;,
INFO:tensorflow:input_ids: [101, 103, 6134, 749, 1300, 3152, 2207, 2110, 5401, 103, 3173, 6440, 3403, 4638, 1353, 2590, 2110, 739, 3173, 2110, 3309, 2458, 2110, 3300, 697, 103, 1914, 3299, 749, 8024, 103, 6821, 3667, 3198, 7313
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [1, 9, 25, 30, 37, 45, 48, 49, 60, 61, 65, 70, 71, 81, 86, 90, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1355 3318  702 1762 2110 1091  704 8024 3403 1114  671  511 2769 3418
 4415 1350    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0]
INFO:tensorflow:[&#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;镰&#39;, &#39;刀&#39;, &#39;刮&#39;, &#39;腋&#39;, &#39;毛&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;我&#39;, &#39;的&#39;, &#39;朋&#39;, &#39;友&#39;, &#39;是&#39;, &#39;个&#39;, &#39;呆&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;十&#39;, &#39;万&#39;, &#39;个&#39;,
INFO:tensorflow:input_ids: [101, 1506, 103, 1506, 1506, 103, 103, 7266, 103, 103, 103, 3688, 103, 1506, 1506, 1506, 1506, 1506, 2769, 4638, 3301, 1351, 3221, 702, 1438, 1506, 1506, 1506, 1506, 1506, 103, 1506, 1506, 1506, 1506,
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [2, 5, 6, 8, 9, 10, 12, 30, 38, 49, 52, 59, 69, 70, 72, 76, 82, 86, 103, 0]
INFO:tensorflow:masked_lm_ids: [1506 1506 1506 1143 1167 5573 1506 1506 1282  679 1506 1506 3683 1506
 1506 5511 1506 5529 1506    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0]
INFO:tensorflow:[&#39;�&#39;, &#39;�&#39;, &#39;就&#39;, &#39;爱&#39;, &#39;这&#39;, &#39;个&#39;, &#39;牌&#39;, &#39;子&#39;, &#39;的&#39;, &#39;糖&#39;, &#39;果&#39;]
INFO:tensorflow:input_ids: [101, 103, 2218, 103, 6821, 702, 4277, 2094, 4638, 5131, 3362, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [4263    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;延&#39;, &#39;参&#39;, &#39;法&#39;, &#39;师&#39;, &#39;品&#39;, &#39;味&#39;, &#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;同&#39;, &#39;走&#39;, &#39;进&#39;, &#39;一&#39;, &#39;片&#39;, &#39;山&#39;, &#39;水&#39;, &#39;，&#39;, &#39;静&#39;, &#39;静&#39;, &#39;的&#39;, &#39;呼&#39;, &#39;吸&#39;, &#39;，&#39;, &#39;安&#39;, &#39;静&#39;, &#39;的&#39;, &#39;欣&#39;, &#39;赏&#39;, &#39;，&#39;, &#39;这&#39;, &#39;就&#39;, &#39;是&#39;, &#39;生&#39;, &#39;活&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 2454, 1346, 3791, 2360, 1501, 103, 782, 4495, 1963, 1398, 6624, 6822, 103, 4275, 2255, 3717, 8024, 7474, 7474, 4638, 1461, 1429, 8024, 2128, 7474, 4638, 3615, 6605, 8024, 6821, 2218, 3221, 4495,
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [6, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1456  671    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;就&#39;, &#39;感&#39;, &#39;恩&#39;, &#39;吧&#39;, &#39;越&#39;, &#39;来&#39;, &#39;越&#39;, &#39;没&#39;, &#39;战&#39;, &#39;斗&#39;, &#39;力&#39;, &#39;了&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 2218, 2697, 103, 1416, 103, 3341, 6632, 3766, 2773, 3159, 1213, 749, 511, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [3, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [2617 6632    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="reshape_tensors_in_dataset" class="doc_header"><code>reshape_tensors_in_dataset</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L424" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>reshape_tensors_in_dataset</code>(<strong><code>example</code></strong>)</p>
</blockquote>
<p>Reshape serialized tensor back to its original shape</p>
<p>Arguments:
    example {Example} -- Example</p>
<p>Returns:
    Example -- Example</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_loss_multiplier" class="doc_header"><code>add_loss_multiplier</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L451" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_loss_multiplier</code>(<strong><code>example</code></strong>, <strong><code>problem</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="set_shape_for_dataset" class="doc_header"><code>set_shape_for_dataset</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L457" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>set_shape_for_dataset</code>(<strong><code>example</code></strong>, <strong><code>feature_desc_dict</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_dummy_features" class="doc_header"><code>get_dummy_features</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L464" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_dummy_features</code>(<strong><code>dataset_dict</code></strong>, <strong><code>feature_desc_dict</code></strong>)</p>
</blockquote>
<p>Get dummy features.
Dummy features are used to make sure every feature dict
at every iteration has the same keys.</p>
<p>Example:
    problem A: {'input_ids': [1,2,3], 'A_label_ids': 1}
    problem B: {'input_ids': [1,2,3], 'B_label_ids': 2}</p>
<p>Then dummy features:
    {'A_label_ids': 0, 'B_label_ids': 0}</p>
<p>At each iteration, we sample a problem, let's say we sampled A
Then:
    feature dict without dummy:
        {'input_ids': [1,2,3], 'A_label_ids': 1}
    feature dict with dummy:
        {'input_ids': [1,2,3], 'A_label_ids': 1, 'B_label_ids':0}</p>
<p>Arguments:
    dataset_dict {dict} -- dict of datasets of all problems</p>
<p>Returns:
    dummy_features -- dict of dummy tensors</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_dummy_features_to_dataset" class="doc_header"><code>add_dummy_features_to_dataset</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L506" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_dummy_features_to_dataset</code>(<strong><code>example</code></strong>, <strong><code>dummy_features</code></strong>)</p>
</blockquote>
<p>Add dummy features to dataset</p>
<p>feature dict without dummy:
    {'input_ids': [1,2,3], 'A_label_ids': 1}
feature dict with dummy:
    {'input_ids': [1,2,3], 'A_label_ids': 1, 'B_label_ids':0}</p>
<p>Arguments:
    example {data example} -- dataset example
    dummy_features {dict} -- dict of dummy tensors</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_tfrecord" class="doc_header"><code>read_tfrecord</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/read_write_tfrecord.py#L524" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_tfrecord</code>(<strong><code>params</code></strong>:<code>BaseParams</code>, <strong><code>mode</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Read and parse TFRecord for every problem</p>
<p>The returned dataset is parsed, reshaped, to_dense tensors
with dummy features.</p>
<p>Arguments:
    params {params} -- params
    mode {str} -- mode, train, eval or predict</p>
<p>Returns:
    dict -- dict with keys: problem name, values: dataset</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

