---

title: Function to Create Datasets


keywords: fastai
sidebar: home_sidebar



nb_path: "source_nbs/07_input_fn.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: source_nbs/07_input_fn.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-1&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train-and-Eval-Dataset">Train and Eval Dataset<a class="anchor-link" href="#Train-and-Eval-Dataset"> </a></h2><p>We can get train and eval dataset by passing a problem assigned params and mode.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="element_length_func" class="doc_header"><code>element_length_func</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/input_fn.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>element_length_func</code>(<strong><code>yield_dict</code></strong>:<code>Dict</code>[<code>str</code>, <code>Tensor</code>])</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_eval_input_fn" class="doc_header"><code>train_eval_input_fn</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/input_fn.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_eval_input_fn</code>(<strong><code>params</code></strong>:<a href="/bert_multitask_learning/params.html#BaseParams"><code>BaseParams</code></a>, <strong><code>mode</code></strong>=<em><code>'train'</code></em>)</p>
</blockquote>
<p>This function will write and read tf record for training
and evaluation.</p>
<p>Arguments:
    params {Params} -- Params objects</p>
<p>Keyword Arguments:
    mode {str} -- ModeKeys (default: {TRAIN})</p>
<p>Returns:
    tf Dataset -- Tensorflow dataset</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered celltag_outputPrepend">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">train_eval_input_fn</span><span class="p">(</span>
    <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">)</span>
<span class="n">eval_dataset</span> <span class="o">=</span> <span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">train_eval_input_fn</span><span class="p">(</span>
    <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">EVAL</span>
<span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">as_numpy_iterator</span><span class="p">())</span>
<span class="n">_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">eval_dataset</span><span class="o">.</span><span class="n">as_numpy_iterator</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:image_input: [[0.30820696 0.32793963 0.5366956  0.38816917 0.40036218 0.3959411
  0.04921183 0.05721554 0.53213454 0.78395215]
 [0.63024512 0.37783302 0.24188715 0.39396367 0.74710608 0.21944181
  0.9126956  0.591
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;延&#39;, &#39;参&#39;, &#39;法&#39;, &#39;师&#39;, &#39;品&#39;, &#39;味&#39;, &#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;同&#39;, &#39;走&#39;, &#39;进&#39;, &#39;一&#39;, &#39;片&#39;, &#39;山&#39;, &#39;水&#39;, &#39;，&#39;, &#39;静&#39;, &#39;静&#39;, &#39;的&#39;, &#39;呼&#39;, &#39;吸&#39;, &#39;，&#39;, &#39;安&#39;, &#39;静&#39;, &#39;的&#39;, &#39;欣&#39;, &#39;赏&#39;, &#39;，&#39;, &#39;这&#39;, &#39;就&#39;, &#39;是&#39;, &#39;生&#39;, &#39;活&#39;, &#39;。&#39;]
INFO:tensorflow:image: [[0.13549992 0.80370666 0.65313431 0.93012199 0.72213015 0.8667986
  0.63323659 0.32622537 0.45220408 0.10011452]
 [0.69814168 0.75051269 0.09380045 0.2214851  0.03177556 0.06417007
  0.86614259 0.029
INFO:tensorflow:input_ids: [101, 2454, 1346, 3791, 2360, 1501, 1456, 782, 4495, 1963, 1398, 6624, 6822, 671, 4275, 2255, 3717, 8024, 7474, 7474, 4638, 1461, 1429, 8024, 2128, 7474, 4638, 3615, 6605, 8024, 6821, 2218, 3221, 4495
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0]
INFO:tensorflow:image_input: [[0.13549992 0.80370666 0.65313431 0.93012199 0.72213015 0.8667986
  0.63323659 0.32622537 0.45220408 0.10011452]
 [0.69814168 0.75051269 0.09380045 0.2214851  0.03177556 0.06417007
  0.86614259 0.029
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:[&#39;对&#39;, &#39;，&#39;, &#39;输&#39;, &#39;给&#39;, &#39;一&#39;, &#39;个&#39;, &#39;女&#39;, &#39;人&#39;, &#39;，&#39;, &#39;的&#39;, &#39;成&#39;, &#39;绩&#39;, &#39;。&#39;, &#39;失&#39;, &#39;望&#39;]
INFO:tensorflow:input_ids: [101, 103, 8024, 6783, 5314, 103, 702, 1957, 782, 8024, 4638, 2768, 5327, 511, 1927, 3307, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [1, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [2190  671    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;今&#39;, &#39;天&#39;, &#39;下&#39;, &#39;午&#39;, &#39;起&#39;, &#39;来&#39;, &#39;看&#39;, &#39;到&#39;, &#39;外&#39;, &#39;面&#39;, &#39;的&#39;, &#39;太&#39;, &#39;阳&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;我&#39;, &#39;第&#39;, &#39;一&#39;, &#39;反&#39;, &#39;应&#39;, &#39;竟&#39;, &#39;然&#39;, &#39;是&#39;, &#39;强&#39;, &#39;烈&#39;, &#39;的&#39;, &#39;想&#39;, &#39;回&#39;, &#39;家&#39;, &#39;泪&#39;, &#39;想&#39;, &#39;我&#39;, &#39;们&#39;, &#39;一&#39;, &#39;起&#39;, &#39;在&#39;, &#39;嘉&#39;, &#39;鱼&#39;,
INFO:tensorflow:input_ids: [101, 103, 1921, 103, 1286, 6629, 3341, 4692, 1168, 1912, 7481, 4638, 1922, 7345, 511, 511, 511, 511, 2769, 5018, 671, 1353, 2418, 4994, 4197, 3221, 2487, 4164, 4638, 2682, 1726, 2157, 3801, 2682, 276
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [1, 3, 36, 38, 40, 46, 48, 56, 58, 61, 63, 66, 72, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [ 791  678  671 1762 7824  511  511 2682  872 2353 2682 4607 3221    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;今&#39;, &#39;年&#39;, &#39;拜&#39;, &#39;年&#39;, &#39;不&#39;, &#39;短&#39;, &#39;信&#39;, &#39;，&#39;, &#39;就&#39;, &#39;在&#39;, &#39;微&#39;, &#39;博&#39;, &#39;拜&#39;, &#39;大&#39;, &#39;年&#39;, &#39;寻&#39;, &#39;龙&#39;, &#39;记&#39;]
INFO:tensorflow:input_ids: [101, 791, 2399, 2876, 2399, 679, 103, 928, 8024, 2218, 1762, 2544, 1300, 2876, 1920, 2399, 2192, 7987, 6381, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [4764    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;浑&#39;, &#39;身&#39;, &#39;酸&#39;, &#39;疼&#39;, &#39;，&#39;, &#39;两&#39;, &#39;腿&#39;, &#39;无&#39;, &#39;力&#39;, &#39;，&#39;, &#39;眼&#39;, &#39;神&#39;, &#39;呆&#39;, &#39;滞&#39;, &#39;，&#39;, &#39;怎&#39;, &#39;么&#39;, &#39;了&#39;]
INFO:tensorflow:input_ids: [101, 3847, 6716, 103, 4563, 8024, 697, 5597, 3187, 1213, 8024, 4706, 4868, 1438, 4005, 8024, 2582, 720, 749, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [7000    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;明&#39;, &#39;显&#39;, &#39;紧&#39;, &#39;张&#39;, &#39;状&#39;, &#39;态&#39;, &#39;没&#39;, &#39;出&#39;, &#39;来&#39;, &#39;，&#39;, &#39;失&#39;, &#39;误&#39;, &#39;多&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 103, 103, 5165, 2476, 4307, 103, 3766, 1139, 3341, 103, 1927, 6428, 1914, 103, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [1, 2, 6, 10, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [3209 3227 2578 8024  511    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;三&#39;, &#39;十&#39;, &#39;年&#39;, &#39;前&#39;, &#39;，&#39;, &#39;老&#39;, &#39;爹&#39;, &#39;带&#39;, &#39;我&#39;, &#39;来&#39;, &#39;这&#39;, &#39;里&#39;, &#39;开&#39;, &#39;会&#39;, &#39;，&#39;, &#39;今&#39;, &#39;天&#39;, &#39;打&#39;, &#39;了&#39;, &#39;个&#39;, &#39;颠&#39;, &#39;倒&#39;, &#39;。&#39;, &#39;我&#39;, &#39;在&#39;, &#39;这&#39;, &#39;里&#39;]
INFO:tensorflow:input_ids: [101, 676, 1282, 2399, 1184, 8024, 5439, 4269, 2372, 2769, 3341, 6821, 7027, 103, 833, 8024, 791, 1921, 2802, 749, 702, 7585, 948, 511, 2769, 1762, 6821, 7027, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [2458    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;好&#39;, &#39;活&#39;, &#39;动&#39;, &#39;呀&#39;, &#39;，&#39;, &#39;给&#39;, &#39;力&#39;, &#39;的&#39;, &#39;商&#39;, &#39;家&#39;, &#39;，&#39;, &#39;必&#39;, &#39;须&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;希&#39;, &#39;望&#39;, &#39;以&#39;, &#39;后&#39;, &#39;多&#39;, &#39;多&#39;, &#39;办&#39;, &#39;活&#39;, &#39;动&#39;, &#39;跟&#39;, &#39;我&#39;, &#39;们&#39;, &#39;互&#39;, &#39;动&#39;, &#39;哈&#39;, &#39;巧&#39;, &#39;慧&#39;, &#39;铣&#39;]
INFO:tensorflow:input_ids: [101, 103, 3833, 1220, 1435, 8024, 5314, 1213, 4638, 1555, 2157, 8024, 2553, 7557, 3118, 2898, 8024, 2361, 3307, 809, 1400, 103, 103, 1215, 103, 1220, 6656, 2769, 812, 757, 1220, 103, 2341, 2716, 7203
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [1, 21, 22, 24, 31, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1962 1914 1914 3833 1506    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;戏&#39;, &#39;，&#39;, &#39;导&#39;, &#39;演&#39;, &#39;是&#39;, &#39;自&#39;, &#39;己&#39;, &#39;蜡&#39;, &#39;烛&#39;]
INFO:tensorflow:input_ids: [101, 782, 4495, 103, 2767, 8024, 2193, 4028, 103, 5632, 2346, 6058, 4169, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [3, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1963 3221    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;听&#39;, &#39;说&#39;, &#39;小&#39;, &#39;米&#39;, &#39;开&#39;, &#39;卖&#39;, &#39;了&#39;, &#39;，&#39;, &#39;刚&#39;, &#39;刚&#39;, &#39;预&#39;, &#39;约&#39;, &#39;了&#39;, &#39;台&#39;, &#39;。&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;因&#39;, &#39;为&#39;, &#39;他&#39;, &#39;是&#39;, &#39;迄&#39;, &#39;今&#39;, &#39;为&#39;, &#39;止&#39;, &#39;最&#39;, &#39;快&#39;, &#39;的&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;月&#39;, &#39;日&#39;, &#39;中&#39;, &#39;午&#39;,
INFO:tensorflow:input_ids: [101, 103, 6432, 2207, 5101, 2458, 1297, 749, 8024, 1157, 1157, 7564, 5276, 749, 1378, 511, 2769, 4263, 2207, 5101, 2797, 3322, 1728, 711, 800, 3221, 6812, 791, 711, 103, 3297, 103, 4638, 2207, 5101, 
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [1, 29, 31, 40, 41, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1420 3632 2571 1286 4157    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;最&#39;, &#39;热&#39;, &#39;时&#39;, &#39;尚&#39;, &#39;榜&#39;, &#39;女&#39;, &#39;人&#39;, &#39;不&#39;, &#39;坏&#39;, &#39;，&#39;, &#39;男&#39;, &#39;人&#39;, &#39;不&#39;, &#39;爱&#39;, &#39;，&#39;, &#39;一&#39;, &#39;个&#39;, &#39;男&#39;, &#39;女&#39;, &#39;必&#39;, &#39;看&#39;, &#39;的&#39;, &#39;微&#39;, &#39;博&#39;, &#39;花&#39;, &#39;心&#39;]
INFO:tensorflow:input_ids: [101, 3297, 4178, 103, 2213, 3528, 1957, 103, 103, 1776, 8024, 4511, 782, 103, 4263, 8024, 671, 702, 4511, 1957, 2553, 4692, 4638, 2544, 1300, 5709, 103, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [3, 7, 8, 13, 26, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [3198  782  679  679 2552    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;回&#39;, &#39;复&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;赞&#39;, &#39;成&#39;, &#39;，&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;米&#39;, &#39;八&#39;, &#39;吴&#39;, &#39;够&#39;, &#39;历&#39;, &#39;史&#39;, &#39;要&#39;, &#39;的&#39;, &#39;陈&#39;, &#39;小&#39;, &#39;奥&#39;, &#39;丁&#39;, &#39;丁&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;肥&#39;, &#39;肥&#39;, &#39;一&#39;, &#39;族&#39;, &#39;大&#39;, &#39;头&#39;, &#39;仔&#39;, &#39;大&#39;, &#39;家&#39;, &#39;团&#39;, &#39;结&#39;, &#39;一&#39;, &#39;致&#39;, &#39;，&#39;,
INFO:tensorflow:input_ids: [101, 1726, 1908, 3118, 2898, 103, 6614, 2768, 103, 1506, 1506, 5101, 103, 1426, 1916, 103, 1380, 6206, 103, 7357, 2207, 1952, 672, 672, 2769, 4263, 2207, 5503, 5503, 671, 3184, 1920, 1928, 798, 1920,
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [5, 8, 12, 15, 18, 40, 42, 45, 57, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [8024 8024 1061 1325 4638 8024 6206 3968 1213    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;剑&#39;, &#39;网&#39;, &#39;乱&#39;, &#39;世&#39;, &#39;长&#39;, &#39;安&#39;, &#39;公&#39;, &#39;测&#39;, &#39;盛&#39;, &#39;典&#39;, &#39;今&#39;, &#39;日&#39;, &#39;开&#39;, &#39;启&#39;, &#39;，&#39;, &#39;海&#39;, &#39;量&#39;, &#39;豪&#39;, &#39;礼&#39;, &#39;火&#39;, &#39;爆&#39;, &#39;开&#39;, &#39;送&#39;, &#39;精&#39;, &#39;美&#39;, &#39;挂&#39;, &#39;件&#39;, &#39;、&#39;, &#39;听&#39;, &#39;雨&#39;, &#39;·&#39;, &#39;汉&#39;, &#39;服&#39;, &#39;娃&#39;, &#39;娃&#39;, &#39;、&#39;, &#39;诙&#39;, &#39;谐&#39;, &#39;双&#39;, &#39;骑&#39;,
INFO:tensorflow:input_ids: [101, 103, 5381, 744, 686, 103, 2128, 103, 103, 103, 1073, 791, 3189, 103, 1423, 8024, 103, 7030, 6498, 4851, 4125, 4255, 2458, 6843, 5125, 5401, 2899, 816, 510, 1420, 7433, 103, 3727, 103, 2015, 2015
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [1, 5, 7, 8, 9, 13, 16, 31, 33, 39, 47, 53, 56, 57, 65, 66, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1187 7270 1062 3844 4670 2458 3862  185 3302 1352 2897 5273 3322  510
 1355 1315    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0]
INFO:tensorflow:[&#39;在&#39;, &#39;街&#39;, &#39;上&#39;, &#39;听&#39;, &#39;见&#39;, &#39;音&#39;, &#39;乐&#39;, &#39;我&#39;, &#39;舞&#39;, &#39;动&#39;, &#39;起&#39;, &#39;来&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;？&#39;, &#39;真&#39;, &#39;的&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;吗&#39;, &#39;？&#39;]
INFO:tensorflow:input_ids: [101, 1762, 6125, 677, 103, 6224, 7509, 727, 2769, 5659, 103, 6629, 3341, 2523, 696, 782, 8043, 4696, 4638, 2523, 696, 782, 1408, 8043, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [4, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1420 1220    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;三&#39;, &#39;毛&#39;, &#39;说&#39;, &#39;我&#39;, &#39;唯&#39;, &#39;一&#39;, &#39;锲&#39;, &#39;而&#39;, &#39;不&#39;, &#39;舍&#39;, &#39;，&#39;, &#39;愿&#39;, &#39;意&#39;, &#39;以&#39;, &#39;自&#39;, &#39;己&#39;, &#39;的&#39;, &#39;生&#39;, &#39;命&#39;, &#39;去&#39;, &#39;努&#39;, &#39;力&#39;, &#39;的&#39;, &#39;，&#39;, &#39;只&#39;, &#39;不&#39;, &#39;过&#39;, &#39;是&#39;, &#39;保&#39;, &#39;守&#39;, &#39;我&#39;, &#39;个&#39;, &#39;人&#39;, &#39;的&#39;, &#39;心&#39;, &#39;怀&#39;, &#39;意&#39;, &#39;念&#39;, &#39;，&#39;, &#39;在&#39;,
INFO:tensorflow:input_ids: [101, 676, 3688, 6432, 103, 1546, 671, 7244, 5445, 103, 103, 8024, 2703, 2692, 103, 5632, 2346, 103, 4495, 103, 1343, 1222, 103, 4638, 8024, 1372, 103, 6814, 103, 924, 2127, 103, 103, 103, 4638, 2552,
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [4, 9, 10, 14, 17, 19, 22, 26, 28, 31, 32, 33, 39, 40, 46, 60, 62, 66, 69, 77]
INFO:tensorflow:masked_lm_ids: [2769  679 5650  809 4638 1462 1213  679 3221 2769  702  782 8024 1762
 8024 3833 4178 4708 3300 3187]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
INFO:tensorflow:[&#39;发&#39;, &#39;表&#39;, &#39;了&#39;, &#39;博&#39;, &#39;文&#39;, &#39;小&#39;, &#39;学&#39;, &#39;美&#39;, &#39;术&#39;, &#39;新&#39;, &#39;课&#39;, &#39;标&#39;, &#39;的&#39;, &#39;反&#39;, &#39;思&#39;, &#39;学&#39;, &#39;习&#39;, &#39;新&#39;, &#39;学&#39;, &#39;期&#39;, &#39;开&#39;, &#39;学&#39;, &#39;有&#39;, &#39;两&#39;, &#39;个&#39;, &#39;多&#39;, &#39;月&#39;, &#39;了&#39;, &#39;，&#39;, &#39;在&#39;, &#39;这&#39;, &#39;段&#39;, &#39;时&#39;, &#39;间&#39;, &#39;的&#39;, &#39;教&#39;, &#39;学&#39;, &#39;计&#39;, &#39;划&#39;, &#39;、&#39;,
INFO:tensorflow:input_ids: [101, 1355, 6134, 749, 1300, 3152, 2207, 2110, 5401, 3318, 3173, 6440, 3403, 4638, 1353, 103, 2110, 739, 3173, 2110, 3309, 103, 2110, 3300, 697, 103, 103, 3299, 749, 8024, 1762, 6821, 3667, 3198, 7313
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [15, 21, 25, 26, 37, 40, 44, 46, 49, 54, 55, 58, 61, 67, 73, 74, 78, 80, 85, 88]
INFO:tensorflow:masked_lm_ids: [2590 2458  702 1914 2110  510 3066 2339 8024 2110 5401 6440 1114 4638
 4385 1762 3136 8024 2552 4157]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
INFO:tensorflow:[&#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;镰&#39;, &#39;刀&#39;, &#39;刮&#39;, &#39;腋&#39;, &#39;毛&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;我&#39;, &#39;的&#39;, &#39;朋&#39;, &#39;友&#39;, &#39;是&#39;, &#39;个&#39;, &#39;呆&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;十&#39;, &#39;万&#39;, &#39;个&#39;,
INFO:tensorflow:input_ids: [101, 1506, 103, 1506, 1506, 1506, 1506, 103, 1143, 1167, 5573, 3688, 103, 1506, 103, 1506, 1506, 1506, 2769, 4638, 103, 1351, 103, 702, 1438, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 150
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [2, 7, 12, 14, 20, 22, 54, 55, 58, 61, 63, 82, 84, 98, 100, 105, 106, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1506 7266 1506 1506 3301 3221 1506 1506 5857 1506 1506 1506 1506 7448
 1506 1506 1506    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0]
INFO:tensorflow:[&#39;�&#39;, &#39;�&#39;, &#39;就&#39;, &#39;爱&#39;, &#39;这&#39;, &#39;个&#39;, &#39;牌&#39;, &#39;子&#39;, &#39;的&#39;, &#39;糖&#39;, &#39;果&#39;]
INFO:tensorflow:input_ids: [101, 2218, 4263, 6821, 702, 103, 2094, 4638, 5131, 3362, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [4277    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;延&#39;, &#39;参&#39;, &#39;法&#39;, &#39;师&#39;, &#39;品&#39;, &#39;味&#39;, &#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;同&#39;, &#39;走&#39;, &#39;进&#39;, &#39;一&#39;, &#39;片&#39;, &#39;山&#39;, &#39;水&#39;, &#39;，&#39;, &#39;静&#39;, &#39;静&#39;, &#39;的&#39;, &#39;呼&#39;, &#39;吸&#39;, &#39;，&#39;, &#39;安&#39;, &#39;静&#39;, &#39;的&#39;, &#39;欣&#39;, &#39;赏&#39;, &#39;，&#39;, &#39;这&#39;, &#39;就&#39;, &#39;是&#39;, &#39;生&#39;, &#39;活&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 2454, 103, 3791, 2360, 1501, 1456, 782, 103, 1963, 1398, 6624, 6822, 671, 4275, 2255, 3717, 8024, 7474, 7474, 4638, 1461, 1429, 8024, 2128, 7474, 4638, 3615, 6605, 8024, 6821, 2218, 103, 4495, 3
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [2, 8, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1346 4495 3221    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;就&#39;, &#39;感&#39;, &#39;恩&#39;, &#39;吧&#39;, &#39;越&#39;, &#39;来&#39;, &#39;越&#39;, &#39;没&#39;, &#39;战&#39;, &#39;斗&#39;, &#39;力&#39;, &#39;了&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 103, 103, 103, 1416, 103, 3341, 6632, 3766, 2773, 3159, 1213, 749, 511, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [1, 2, 3, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [2218 2697 2617 6632    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:sampling weights: 
INFO:tensorflow:weibo_fake_cls_weibo_ner: 0.5
INFO:tensorflow:weibo_fake_multi_cls: 0.25
INFO:tensorflow:weibo_masklm: 0.25
INFO:tensorflow:sampling weights: 
INFO:tensorflow:weibo_fake_cls_weibo_ner: 0.5
INFO:tensorflow:weibo_fake_multi_cls: 0.25
INFO:tensorflow:weibo_masklm: 0.25
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Predict-Dataset">Predict Dataset<a class="anchor-link" href="#Predict-Dataset"> </a></h2><p>We can create a predict dataset by passing list/generator of inputs and problem assigned params.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict_input_fn" class="doc_header"><code>predict_input_fn</code><a href="https://github.com/JayYip/bert_multitask_learning/tree/master/bert_multitask_learning/input_fn.py#L86" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict_input_fn</code>(<strong><code>input_file_or_list</code></strong>:<code>Union</code>[<code>str</code>, <code>List</code>[<code>str</code>]], <strong><code>params</code></strong>:<a href="/bert_multitask_learning/params.html#BaseParams"><code>BaseParams</code></a>, <strong><code>mode</code></strong>=<em><code>'infer'</code></em>, <strong><code>labels_in_input</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Input function that takes a file path or list of string and
convert it to tf.dataset</p>
<p>Example:
    predict_fn = lambda: predict_input_fn('test.txt', params)
    pred = estimator.predict(predict_fn)</p>
<p>Arguments:
    input_file_or_list {str or list} -- file path or list of string
    params {Params} -- Params object</p>
<p>Keyword Arguments:
    mode {str} -- ModeKeys (default: {PREDICT})</p>
<p>Returns:
    tf dataset -- tf dataset</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Single-modal-inputs">Single modal inputs<a class="anchor-link" href="#Single-modal-inputs"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">single_dataset</span> <span class="o">=</span> <span class="n">predict_input_fn</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;this is a test&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<span class="n">first_batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">single_dataset</span><span class="o">.</span><span class="n">as_numpy_iterator</span><span class="p">())</span>
<span class="k">assert</span> <span class="n">first_batch</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span>
                    <span class="mi">101</span><span class="p">,</span>  <span class="mi">8554</span><span class="p">,</span>  <span class="mi">8310</span><span class="p">,</span>   <span class="mi">143</span><span class="p">,</span> <span class="mi">10060</span><span class="p">,</span>   <span class="mi">102</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>INFO:tensorflow:this is a test
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:this is a test
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:this is a test
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:this is a test
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:this is a test
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:this is a test
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multi-modal-inputs">Multi-modal inputs<a class="anchor-link" href="#Multi-modal-inputs"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mm_input</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;this is a test&#39;</span><span class="p">,</span>
                <span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)}]</span> <span class="o">*</span> <span class="mi">5</span>
<span class="n">mm_dataset</span> <span class="o">=</span> <span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">predict_input_fn</span><span class="p">(</span>
    <span class="n">mm_input</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<span class="n">first_batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">mm_dataset</span><span class="o">.</span><span class="n">as_numpy_iterator</span><span class="p">())</span>
<span class="k">assert</span> <span class="n">first_batch</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span>
                    <span class="mi">101</span><span class="p">,</span>  <span class="mi">8554</span><span class="p">,</span>  <span class="mi">8310</span><span class="p">,</span>   <span class="mi">143</span><span class="p">,</span> <span class="mi">10060</span><span class="p">,</span>   <span class="mi">102</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">first_batch</span><span class="p">[</span><span class="s1">&#39;image_input&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>INFO:tensorflow:text: this is a test
INFO:tensorflow:image: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:image_input: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: this is a test
INFO:tensorflow:image: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:image_input: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: this is a test
INFO:tensorflow:image: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:image_input: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: this is a test
INFO:tensorflow:image: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:image_input: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: this is a test
INFO:tensorflow:image: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:image_input: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: this is a test
INFO:tensorflow:image: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:input_ids: [101, 8554, 8310, 143, 10060, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0]
INFO:tensorflow:image_input: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

