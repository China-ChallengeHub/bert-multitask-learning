---

title: Top Models


keywords: fastai
sidebar: home_sidebar



nb_path: "source_nbs/12_top.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: source_nbs/12_top.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-1&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">bert_multitask_learning.test_base</span> <span class="kn">import</span> <span class="n">TestBase</span>
<span class="kn">from</span> <span class="nn">bert_multitask_learning.input_fn</span> <span class="kn">import</span> <span class="n">train_eval_input_fn</span>
<span class="kn">from</span> <span class="nn">bert_multitask_learning.params</span> <span class="kn">import</span> <span class="n">BaseParams</span>
<span class="n">test_base</span> <span class="o">=</span> <span class="n">TestBase</span><span class="p">()</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">test_base</span><span class="o">.</span><span class="n">params</span>

<span class="n">params</span><span class="o">.</span><span class="n">assign_problem</span><span class="p">(</span><span class="s1">&#39;weibo_fake_ner&amp;weibo_fake_cls|weibo_fake_multi_cls|weibo_masklm|weibo_pretrain&#39;</span><span class="p">)</span>

<span class="n">hidden_dim</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">bert_config</span><span class="o">.</span><span class="n">hidden_size</span>

<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_eval_input_fn</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<span class="n">one_batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">as_numpy_iterator</span><span class="p">())</span>

<span class="c1"># prepare top dummy inputs</span>
<span class="c1"># non-empty inputs</span>
<span class="k">def</span> <span class="nf">create_dummy_features_hidden_features</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">768</span><span class="p">,</span> <span class="n">sample_features</span><span class="p">:</span> <span class="nb">dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">seq_len</span> <span class="o">=</span> <span class="n">sample_features</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dummy_features</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">feature_name</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">sample_features</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dummy_features</span><span class="p">[</span><span class="n">feature_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">*</span><span class="n">feature</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">feature</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dummy_features</span><span class="p">[</span><span class="n">feature_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">feature</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">dummy_features</span><span class="p">[</span><span class="s1">&#39;model_input_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">dummy_features</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">dummy_hidden</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;seq&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
        <span class="s1">&#39;pooled&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">dummy_features</span><span class="p">,</span> <span class="n">dummy_hidden</span>

<span class="k">def</span> <span class="nf">test_top_layer</span><span class="p">(</span><span class="n">top_class</span><span class="p">,</span> <span class="n">problem</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">BaseParams</span><span class="p">,</span> <span class="n">sample_features</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_class</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
    <span class="n">top_layer</span> <span class="o">=</span> <span class="n">top_class</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">problem</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># non empty test</span>
    <span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span> <span class="o">=</span> <span class="n">create_dummy_features_hidden_features</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">sample_features</span><span class="o">=</span><span class="n">sample_features</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">top_layer</span><span class="p">((</span><span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">top_layer</span><span class="p">((</span><span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">EVAL</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">top_layer</span><span class="p">((</span><span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">PREDICT</span><span class="p">)</span>

    <span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span> <span class="o">=</span> <span class="n">create_dummy_features_hidden_features</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">sample_features</span><span class="o">=</span><span class="n">sample_features</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">top_layer</span><span class="p">((</span><span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">top_layer</span><span class="p">((</span><span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">EVAL</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">top_layer</span><span class="p">((</span><span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">PREDICT</span><span class="p">)</span>

    <span class="c1"># empty test</span>
    <span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span> <span class="o">=</span> <span class="n">create_dummy_features_hidden_features</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">sample_features</span><span class="o">=</span><span class="n">sample_features</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">top_layer</span><span class="p">((</span><span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">top_layer</span><span class="p">((</span><span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">EVAL</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">top_layer</span><span class="p">((</span><span class="n">d_f</span><span class="p">,</span> <span class="n">d_h</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">PREDICT</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>WARNING:root:bert_config not exists. will load model from huggingface checkpoint.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Adding new problem weibo_fake_ner, problem type: seq_tag
Adding new problem weibo_cws, problem type: seq_tag
Adding new problem weibo_fake_multi_cls, problem type: multi_cls
Adding new problem weibo_fake_cls, problem type: cls
Adding new problem weibo_masklm, problem type: masklm
Adding new problem weibo_pretrain, problem type: pretrain
INFO:tensorflow:[&#39;科&#39;, &#39;技&#39;, &#39;全&#39;, &#39;方&#39;, &#39;位&#39;, &#39;资&#39;, &#39;讯&#39;, &#39;智&#39;, &#39;能&#39;, &#39;，&#39;, &#39;快&#39;, &#39;捷&#39;, &#39;的&#39;, &#39;汽&#39;, &#39;车&#39;, &#39;生&#39;, &#39;活&#39;, &#39;需&#39;, &#39;要&#39;, &#39;有&#39;, &#39;三&#39;, &#39;屏&#39;, &#39;一&#39;, &#39;云&#39;, &#39;爱&#39;, &#39;你&#39;]
INFO:tensorflow:input_ids: [101, 4906, 2825, 1059, 3175, 855, 6598, 6380, 3255, 5543, 8024, 2571, 2949, 4638, 3749, 6756, 4495, 3833, 7444, 6206, 3300, 676, 2242, 671, 756, 4263, 872, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;对&#39;, &#39;，&#39;, &#39;输&#39;, &#39;给&#39;, &#39;一&#39;, &#39;个&#39;, &#39;女&#39;, &#39;人&#39;, &#39;，&#39;, &#39;的&#39;, &#39;成&#39;, &#39;绩&#39;, &#39;。&#39;, &#39;失&#39;, &#39;望&#39;]
INFO:tensorflow:input_ids: [101, 2190, 8024, 6783, 5314, 671, 702, 1957, 782, 8024, 4638, 2768, 5327, 511, 1927, 3307, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;今&#39;, &#39;天&#39;, &#39;下&#39;, &#39;午&#39;, &#39;起&#39;, &#39;来&#39;, &#39;看&#39;, &#39;到&#39;, &#39;外&#39;, &#39;面&#39;, &#39;的&#39;, &#39;太&#39;, &#39;阳&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;我&#39;, &#39;第&#39;, &#39;一&#39;, &#39;反&#39;, &#39;应&#39;, &#39;竟&#39;, &#39;然&#39;, &#39;是&#39;, &#39;强&#39;, &#39;烈&#39;, &#39;的&#39;, &#39;想&#39;, &#39;回&#39;, &#39;家&#39;, &#39;泪&#39;, &#39;想&#39;, &#39;我&#39;, &#39;们&#39;, &#39;一&#39;, &#39;起&#39;, &#39;在&#39;, &#39;嘉&#39;, &#39;鱼&#39;,
INFO:tensorflow:input_ids: [101, 791, 1921, 678, 1286, 6629, 3341, 4692, 1168, 1912, 7481, 4638, 1922, 7345, 511, 511, 511, 511, 2769, 5018, 671, 1353, 2418, 4994, 4197, 3221, 2487, 4164, 4638, 2682, 1726, 2157, 3801, 2682, 276
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 1, 5, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 3, 7, 7, 8, 8, 8, 8
INFO:tensorflow:[&#39;今&#39;, &#39;年&#39;, &#39;拜&#39;, &#39;年&#39;, &#39;不&#39;, &#39;短&#39;, &#39;信&#39;, &#39;，&#39;, &#39;就&#39;, &#39;在&#39;, &#39;微&#39;, &#39;博&#39;, &#39;拜&#39;, &#39;大&#39;, &#39;年&#39;, &#39;寻&#39;, &#39;龙&#39;, &#39;记&#39;]
INFO:tensorflow:input_ids: [101, 791, 2399, 2876, 2399, 679, 4764, 928, 8024, 2218, 1762, 2544, 1300, 2876, 1920, 2399, 2192, 7987, 6381, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;浑&#39;, &#39;身&#39;, &#39;酸&#39;, &#39;疼&#39;, &#39;，&#39;, &#39;两&#39;, &#39;腿&#39;, &#39;无&#39;, &#39;力&#39;, &#39;，&#39;, &#39;眼&#39;, &#39;神&#39;, &#39;呆&#39;, &#39;滞&#39;, &#39;，&#39;, &#39;怎&#39;, &#39;么&#39;, &#39;了&#39;]
INFO:tensorflow:input_ids: [101, 3847, 6716, 7000, 4563, 8024, 697, 5597, 3187, 1213, 8024, 4706, 4868, 1438, 4005, 8024, 2582, 720, 749, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;明&#39;, &#39;显&#39;, &#39;紧&#39;, &#39;张&#39;, &#39;状&#39;, &#39;态&#39;, &#39;没&#39;, &#39;出&#39;, &#39;来&#39;, &#39;，&#39;, &#39;失&#39;, &#39;误&#39;, &#39;多&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 3209, 3227, 5165, 2476, 4307, 2578, 3766, 1139, 3341, 8024, 1927, 6428, 1914, 511, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;三&#39;, &#39;十&#39;, &#39;年&#39;, &#39;前&#39;, &#39;，&#39;, &#39;老&#39;, &#39;爹&#39;, &#39;带&#39;, &#39;我&#39;, &#39;来&#39;, &#39;这&#39;, &#39;里&#39;, &#39;开&#39;, &#39;会&#39;, &#39;，&#39;, &#39;今&#39;, &#39;天&#39;, &#39;打&#39;, &#39;了&#39;, &#39;个&#39;, &#39;颠&#39;, &#39;倒&#39;, &#39;。&#39;, &#39;我&#39;, &#39;在&#39;, &#39;这&#39;, &#39;里&#39;]
INFO:tensorflow:input_ids: [101, 676, 1282, 2399, 1184, 8024, 5439, 4269, 2372, 2769, 3341, 6821, 7027, 2458, 833, 8024, 791, 1921, 2802, 749, 702, 7585, 948, 511, 2769, 1762, 6821, 7027, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;好&#39;, &#39;活&#39;, &#39;动&#39;, &#39;呀&#39;, &#39;，&#39;, &#39;给&#39;, &#39;力&#39;, &#39;的&#39;, &#39;商&#39;, &#39;家&#39;, &#39;，&#39;, &#39;必&#39;, &#39;须&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;希&#39;, &#39;望&#39;, &#39;以&#39;, &#39;后&#39;, &#39;多&#39;, &#39;多&#39;, &#39;办&#39;, &#39;活&#39;, &#39;动&#39;, &#39;跟&#39;, &#39;我&#39;, &#39;们&#39;, &#39;互&#39;, &#39;动&#39;, &#39;哈&#39;, &#39;巧&#39;, &#39;慧&#39;, &#39;铣&#39;]
INFO:tensorflow:input_ids: [101, 1962, 3833, 1220, 1435, 8024, 5314, 1213, 4638, 1555, 2157, 8024, 2553, 7557, 3118, 2898, 8024, 2361, 3307, 809, 1400, 1914, 1914, 1215, 3833, 1220, 6656, 2769, 812, 757, 1220, 1506, 2341, 2716,
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;戏&#39;, &#39;，&#39;, &#39;导&#39;, &#39;演&#39;, &#39;是&#39;, &#39;自&#39;, &#39;己&#39;, &#39;蜡&#39;, &#39;烛&#39;]
INFO:tensorflow:input_ids: [101, 782, 4495, 1963, 2767, 8024, 2193, 4028, 3221, 5632, 2346, 6058, 4169, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;听&#39;, &#39;说&#39;, &#39;小&#39;, &#39;米&#39;, &#39;开&#39;, &#39;卖&#39;, &#39;了&#39;, &#39;，&#39;, &#39;刚&#39;, &#39;刚&#39;, &#39;预&#39;, &#39;约&#39;, &#39;了&#39;, &#39;台&#39;, &#39;。&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;因&#39;, &#39;为&#39;, &#39;他&#39;, &#39;是&#39;, &#39;迄&#39;, &#39;今&#39;, &#39;为&#39;, &#39;止&#39;, &#39;最&#39;, &#39;快&#39;, &#39;的&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;月&#39;, &#39;日&#39;, &#39;中&#39;, &#39;午&#39;,
INFO:tensorflow:input_ids: [101, 1420, 6432, 2207, 5101, 2458, 1297, 749, 8024, 1157, 1157, 7564, 5276, 749, 1378, 511, 2769, 4263, 2207, 5101, 2797, 3322, 1728, 711, 800, 3221, 6812, 791, 711, 3632, 3297, 2571, 4638, 2207, 510
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;科&#39;, &#39;技&#39;, &#39;全&#39;, &#39;方&#39;, &#39;位&#39;, &#39;资&#39;, &#39;讯&#39;, &#39;智&#39;, &#39;能&#39;, &#39;，&#39;, &#39;快&#39;, &#39;捷&#39;, &#39;的&#39;, &#39;汽&#39;, &#39;车&#39;, &#39;生&#39;, &#39;活&#39;, &#39;需&#39;, &#39;要&#39;, &#39;有&#39;, &#39;三&#39;, &#39;屏&#39;, &#39;一&#39;, &#39;云&#39;, &#39;爱&#39;, &#39;你&#39;]
INFO:tensorflow:input_ids: [101, 4906, 2825, 1059, 3175, 855, 6598, 6380, 3255, 5543, 8024, 2571, 2949, 4638, 3749, 6756, 4495, 3833, 7444, 6206, 3300, 676, 2242, 671, 756, 4263, 872, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;对&#39;, &#39;，&#39;, &#39;输&#39;, &#39;给&#39;, &#39;一&#39;, &#39;个&#39;, &#39;女&#39;, &#39;人&#39;, &#39;，&#39;, &#39;的&#39;, &#39;成&#39;, &#39;绩&#39;, &#39;。&#39;, &#39;失&#39;, &#39;望&#39;]
INFO:tensorflow:input_ids: [101, 2190, 8024, 6783, 5314, 671, 702, 1957, 782, 8024, 4638, 2768, 5327, 511, 1927, 3307, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;今&#39;, &#39;天&#39;, &#39;下&#39;, &#39;午&#39;, &#39;起&#39;, &#39;来&#39;, &#39;看&#39;, &#39;到&#39;, &#39;外&#39;, &#39;面&#39;, &#39;的&#39;, &#39;太&#39;, &#39;阳&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;我&#39;, &#39;第&#39;, &#39;一&#39;, &#39;反&#39;, &#39;应&#39;, &#39;竟&#39;, &#39;然&#39;, &#39;是&#39;, &#39;强&#39;, &#39;烈&#39;, &#39;的&#39;, &#39;想&#39;, &#39;回&#39;, &#39;家&#39;, &#39;泪&#39;, &#39;想&#39;, &#39;我&#39;, &#39;们&#39;, &#39;一&#39;, &#39;起&#39;, &#39;在&#39;, &#39;嘉&#39;, &#39;鱼&#39;,
INFO:tensorflow:input_ids: [101, 791, 1921, 678, 1286, 6629, 3341, 4692, 1168, 1912, 7481, 4638, 1922, 7345, 511, 511, 511, 511, 2769, 5018, 671, 1353, 2418, 4994, 4197, 3221, 2487, 4164, 4638, 2682, 1726, 2157, 3801, 2682, 276
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_cls_label_ids: 1
INFO:tensorflow:[&#39;今&#39;, &#39;年&#39;, &#39;拜&#39;, &#39;年&#39;, &#39;不&#39;, &#39;短&#39;, &#39;信&#39;, &#39;，&#39;, &#39;就&#39;, &#39;在&#39;, &#39;微&#39;, &#39;博&#39;, &#39;拜&#39;, &#39;大&#39;, &#39;年&#39;, &#39;寻&#39;, &#39;龙&#39;, &#39;记&#39;]
INFO:tensorflow:input_ids: [101, 791, 2399, 2876, 2399, 679, 4764, 928, 8024, 2218, 1762, 2544, 1300, 2876, 1920, 2399, 2192, 7987, 6381, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;浑&#39;, &#39;身&#39;, &#39;酸&#39;, &#39;疼&#39;, &#39;，&#39;, &#39;两&#39;, &#39;腿&#39;, &#39;无&#39;, &#39;力&#39;, &#39;，&#39;, &#39;眼&#39;, &#39;神&#39;, &#39;呆&#39;, &#39;滞&#39;, &#39;，&#39;, &#39;怎&#39;, &#39;么&#39;, &#39;了&#39;]
INFO:tensorflow:input_ids: [101, 3847, 6716, 7000, 4563, 8024, 697, 5597, 3187, 1213, 8024, 4706, 4868, 1438, 4005, 8024, 2582, 720, 749, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;明&#39;, &#39;显&#39;, &#39;紧&#39;, &#39;张&#39;, &#39;状&#39;, &#39;态&#39;, &#39;没&#39;, &#39;出&#39;, &#39;来&#39;, &#39;，&#39;, &#39;失&#39;, &#39;误&#39;, &#39;多&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 3209, 3227, 5165, 2476, 4307, 2578, 3766, 1139, 3341, 8024, 1927, 6428, 1914, 511, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;三&#39;, &#39;十&#39;, &#39;年&#39;, &#39;前&#39;, &#39;，&#39;, &#39;老&#39;, &#39;爹&#39;, &#39;带&#39;, &#39;我&#39;, &#39;来&#39;, &#39;这&#39;, &#39;里&#39;, &#39;开&#39;, &#39;会&#39;, &#39;，&#39;, &#39;今&#39;, &#39;天&#39;, &#39;打&#39;, &#39;了&#39;, &#39;个&#39;, &#39;颠&#39;, &#39;倒&#39;, &#39;。&#39;, &#39;我&#39;, &#39;在&#39;, &#39;这&#39;, &#39;里&#39;]
INFO:tensorflow:input_ids: [101, 676, 1282, 2399, 1184, 8024, 5439, 4269, 2372, 2769, 3341, 6821, 7027, 2458, 833, 8024, 791, 1921, 2802, 749, 702, 7585, 948, 511, 2769, 1762, 6821, 7027, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;好&#39;, &#39;活&#39;, &#39;动&#39;, &#39;呀&#39;, &#39;，&#39;, &#39;给&#39;, &#39;力&#39;, &#39;的&#39;, &#39;商&#39;, &#39;家&#39;, &#39;，&#39;, &#39;必&#39;, &#39;须&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;希&#39;, &#39;望&#39;, &#39;以&#39;, &#39;后&#39;, &#39;多&#39;, &#39;多&#39;, &#39;办&#39;, &#39;活&#39;, &#39;动&#39;, &#39;跟&#39;, &#39;我&#39;, &#39;们&#39;, &#39;互&#39;, &#39;动&#39;, &#39;哈&#39;, &#39;巧&#39;, &#39;慧&#39;, &#39;铣&#39;]
INFO:tensorflow:input_ids: [101, 1962, 3833, 1220, 1435, 8024, 5314, 1213, 4638, 1555, 2157, 8024, 2553, 7557, 3118, 2898, 8024, 2361, 3307, 809, 1400, 1914, 1914, 1215, 3833, 1220, 6656, 2769, 812, 757, 1220, 1506, 2341, 2716,
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;戏&#39;, &#39;，&#39;, &#39;导&#39;, &#39;演&#39;, &#39;是&#39;, &#39;自&#39;, &#39;己&#39;, &#39;蜡&#39;, &#39;烛&#39;]
INFO:tensorflow:input_ids: [101, 782, 4495, 1963, 2767, 8024, 2193, 4028, 3221, 5632, 2346, 6058, 4169, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;听&#39;, &#39;说&#39;, &#39;小&#39;, &#39;米&#39;, &#39;开&#39;, &#39;卖&#39;, &#39;了&#39;, &#39;，&#39;, &#39;刚&#39;, &#39;刚&#39;, &#39;预&#39;, &#39;约&#39;, &#39;了&#39;, &#39;台&#39;, &#39;。&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;因&#39;, &#39;为&#39;, &#39;他&#39;, &#39;是&#39;, &#39;迄&#39;, &#39;今&#39;, &#39;为&#39;, &#39;止&#39;, &#39;最&#39;, &#39;快&#39;, &#39;的&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;月&#39;, &#39;日&#39;, &#39;中&#39;, &#39;午&#39;,
INFO:tensorflow:input_ids: [101, 1420, 6432, 2207, 5101, 2458, 1297, 749, 8024, 1157, 1157, 7564, 5276, 749, 1378, 511, 2769, 4263, 2207, 5101, 2797, 3322, 1728, 711, 800, 3221, 6812, 791, 711, 3632, 3297, 2571, 4638, 2207, 510
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;一&#39;, &#39;节&#39;, &#39;课&#39;, &#39;的&#39;, &#39;时&#39;, &#39;间&#39;, &#39;真&#39;, &#39;心&#39;, &#39;感&#39;, &#39;动&#39;, &#39;了&#39;, &#39;李&#39;, &#39;开&#39;, &#39;复&#39;, &#39;感&#39;, &#39;动&#39;]
INFO:tensorflow:input_ids: [101, 671, 5688, 6440, 4638, 3198, 7313, 4696, 2552, 2697, 1220, 749, 3330, 2458, 1908, 2697, 1220, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 3, 7, 7, 8, 8, 9]
INFO:tensorflow:[&#39;回&#39;, &#39;复&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;赞&#39;, &#39;成&#39;, &#39;，&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;米&#39;, &#39;八&#39;, &#39;吴&#39;, &#39;够&#39;, &#39;历&#39;, &#39;史&#39;, &#39;要&#39;, &#39;的&#39;, &#39;陈&#39;, &#39;小&#39;, &#39;奥&#39;, &#39;丁&#39;, &#39;丁&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;肥&#39;, &#39;肥&#39;, &#39;一&#39;, &#39;族&#39;, &#39;大&#39;, &#39;头&#39;, &#39;仔&#39;, &#39;大&#39;, &#39;家&#39;, &#39;团&#39;, &#39;结&#39;, &#39;一&#39;, &#39;致&#39;, &#39;，&#39;,
INFO:tensorflow:input_ids: [101, 1726, 1908, 3118, 2898, 8024, 6614, 2768, 8024, 1506, 1506, 5101, 1061, 1426, 1916, 1325, 1380, 6206, 4638, 7357, 2207, 1952, 672, 672, 2769, 4263, 2207, 5503, 5503, 671, 3184, 1920, 1928, 798, 
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 3, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 0, 4, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;剑&#39;, &#39;网&#39;, &#39;乱&#39;, &#39;世&#39;, &#39;长&#39;, &#39;安&#39;, &#39;公&#39;, &#39;测&#39;, &#39;盛&#39;, &#39;典&#39;, &#39;今&#39;, &#39;日&#39;, &#39;开&#39;, &#39;启&#39;, &#39;，&#39;, &#39;海&#39;, &#39;量&#39;, &#39;豪&#39;, &#39;礼&#39;, &#39;火&#39;, &#39;爆&#39;, &#39;开&#39;, &#39;送&#39;, &#39;精&#39;, &#39;美&#39;, &#39;挂&#39;, &#39;件&#39;, &#39;、&#39;, &#39;听&#39;, &#39;雨&#39;, &#39;·&#39;, &#39;汉&#39;, &#39;服&#39;, &#39;娃&#39;, &#39;娃&#39;, &#39;、&#39;, &#39;诙&#39;, &#39;谐&#39;, &#39;双&#39;, &#39;骑&#39;,
INFO:tensorflow:input_ids: [101, 1187, 5381, 744, 686, 7270, 2128, 1062, 3844, 4670, 1073, 791, 3189, 2458, 1423, 8024, 3862, 7030, 6498, 4851, 4125, 4255, 2458, 6843, 5125, 5401, 2899, 816, 510, 1420, 7433, 185, 3727, 3302, 20
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8
INFO:tensorflow:[&#39;在&#39;, &#39;街&#39;, &#39;上&#39;, &#39;听&#39;, &#39;见&#39;, &#39;音&#39;, &#39;乐&#39;, &#39;我&#39;, &#39;舞&#39;, &#39;动&#39;, &#39;起&#39;, &#39;来&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;？&#39;, &#39;真&#39;, &#39;的&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;吗&#39;, &#39;？&#39;]
INFO:tensorflow:input_ids: [101, 1762, 6125, 677, 1420, 6224, 7509, 727, 2769, 5659, 1220, 6629, 3341, 2523, 696, 782, 8043, 4696, 4638, 2523, 696, 782, 1408, 8043, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;三&#39;, &#39;毛&#39;, &#39;说&#39;, &#39;我&#39;, &#39;唯&#39;, &#39;一&#39;, &#39;锲&#39;, &#39;而&#39;, &#39;不&#39;, &#39;舍&#39;, &#39;，&#39;, &#39;愿&#39;, &#39;意&#39;, &#39;以&#39;, &#39;自&#39;, &#39;己&#39;, &#39;的&#39;, &#39;生&#39;, &#39;命&#39;, &#39;去&#39;, &#39;努&#39;, &#39;力&#39;, &#39;的&#39;, &#39;，&#39;, &#39;只&#39;, &#39;不&#39;, &#39;过&#39;, &#39;是&#39;, &#39;保&#39;, &#39;守&#39;, &#39;我&#39;, &#39;个&#39;, &#39;人&#39;, &#39;的&#39;, &#39;心&#39;, &#39;怀&#39;, &#39;意&#39;, &#39;念&#39;, &#39;，&#39;, &#39;在&#39;,
INFO:tensorflow:input_ids: [101, 676, 3688, 6432, 2769, 1546, 671, 7244, 5445, 679, 5650, 8024, 2703, 2692, 809, 5632, 2346, 4638, 4495, 1462, 1343, 1222, 1213, 4638, 8024, 1372, 679, 6814, 3221, 924, 2127, 2769, 702, 782, 4638
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 3, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8
INFO:tensorflow:[&#39;星&#39;, &#39;期&#39;, &#39;天&#39;, &#39;的&#39;, &#39;早&#39;, &#39;晨&#39;, &#39;七&#39;, &#39;点&#39;, &#39;学&#39;, &#39;车&#39;, &#39;，&#39;, &#39;驾&#39;, &#39;校&#39;, &#39;太&#39;, &#39;给&#39;, &#39;力&#39;, &#39;。&#39;, &#39;我&#39;, &#39;的&#39;, &#39;头&#39;, &#39;发&#39;, &#39;都&#39;, &#39;没&#39;, &#39;有&#39;, &#39;洗&#39;]
INFO:tensorflow:input_ids: [101, 3215, 3309, 1921, 4638, 3193, 3247, 673, 4157, 2110, 6756, 8024, 7730, 3413, 1922, 5314, 1213, 511, 2769, 4638, 1928, 1355, 6963, 3766, 3300, 3819, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;发&#39;, &#39;表&#39;, &#39;了&#39;, &#39;博&#39;, &#39;文&#39;, &#39;小&#39;, &#39;学&#39;, &#39;美&#39;, &#39;术&#39;, &#39;新&#39;, &#39;课&#39;, &#39;标&#39;, &#39;的&#39;, &#39;反&#39;, &#39;思&#39;, &#39;学&#39;, &#39;习&#39;, &#39;新&#39;, &#39;学&#39;, &#39;期&#39;, &#39;开&#39;, &#39;学&#39;, &#39;有&#39;, &#39;两&#39;, &#39;个&#39;, &#39;多&#39;, &#39;月&#39;, &#39;了&#39;, &#39;，&#39;, &#39;在&#39;, &#39;这&#39;, &#39;段&#39;, &#39;时&#39;, &#39;间&#39;, &#39;的&#39;, &#39;教&#39;, &#39;学&#39;, &#39;计&#39;, &#39;划&#39;, &#39;、&#39;,
INFO:tensorflow:input_ids: [101, 1355, 6134, 749, 1300, 3152, 2207, 2110, 5401, 3318, 3173, 6440, 3403, 4638, 1353, 2590, 2110, 739, 3173, 2110, 3309, 2458, 2110, 3300, 697, 702, 1914, 3299, 749, 8024, 1762, 6821, 3667, 3198, 7
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8
INFO:tensorflow:[&#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;镰&#39;, &#39;刀&#39;, &#39;刮&#39;, &#39;腋&#39;, &#39;毛&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;我&#39;, &#39;的&#39;, &#39;朋&#39;, &#39;友&#39;, &#39;是&#39;, &#39;个&#39;, &#39;呆&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;十&#39;, &#39;万&#39;, &#39;个&#39;,
INFO:tensorflow:input_ids: [101, 1506, 1506, 1506, 1506, 1506, 1506, 7266, 1143, 1167, 5573, 3688, 1506, 1506, 1506, 1506, 1506, 1506, 2769, 4638, 3301, 1351, 3221, 702, 1438, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 150
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 3
INFO:tensorflow:[&#39;�&#39;, &#39;�&#39;, &#39;就&#39;, &#39;爱&#39;, &#39;这&#39;, &#39;个&#39;, &#39;牌&#39;, &#39;子&#39;, &#39;的&#39;, &#39;糖&#39;, &#39;果&#39;]
INFO:tensorflow:input_ids: [101, 2218, 4263, 6821, 702, 4277, 2094, 4638, 5131, 3362, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;延&#39;, &#39;参&#39;, &#39;法&#39;, &#39;师&#39;, &#39;品&#39;, &#39;味&#39;, &#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;同&#39;, &#39;走&#39;, &#39;进&#39;, &#39;一&#39;, &#39;片&#39;, &#39;山&#39;, &#39;水&#39;, &#39;，&#39;, &#39;静&#39;, &#39;静&#39;, &#39;的&#39;, &#39;呼&#39;, &#39;吸&#39;, &#39;，&#39;, &#39;安&#39;, &#39;静&#39;, &#39;的&#39;, &#39;欣&#39;, &#39;赏&#39;, &#39;，&#39;, &#39;这&#39;, &#39;就&#39;, &#39;是&#39;, &#39;生&#39;, &#39;活&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 2454, 1346, 3791, 2360, 1501, 1456, 782, 4495, 1963, 1398, 6624, 6822, 671, 4275, 2255, 3717, 8024, 7474, 7474, 4638, 1461, 1429, 8024, 2128, 7474, 4638, 3615, 6605, 8024, 6821, 2218, 3221, 4495
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_ner_label_ids: [9, 3, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9]
INFO:tensorflow:[&#39;一&#39;, &#39;节&#39;, &#39;课&#39;, &#39;的&#39;, &#39;时&#39;, &#39;间&#39;, &#39;真&#39;, &#39;心&#39;, &#39;感&#39;, &#39;动&#39;, &#39;了&#39;, &#39;李&#39;, &#39;开&#39;, &#39;复&#39;, &#39;感&#39;, &#39;动&#39;]
INFO:tensorflow:input_ids: [101, 671, 5688, 6440, 4638, 3198, 7313, 4696, 2552, 2697, 1220, 749, 3330, 2458, 1908, 2697, 1220, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 1
INFO:tensorflow:[&#39;回&#39;, &#39;复&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;赞&#39;, &#39;成&#39;, &#39;，&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;米&#39;, &#39;八&#39;, &#39;吴&#39;, &#39;够&#39;, &#39;历&#39;, &#39;史&#39;, &#39;要&#39;, &#39;的&#39;, &#39;陈&#39;, &#39;小&#39;, &#39;奥&#39;, &#39;丁&#39;, &#39;丁&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;肥&#39;, &#39;肥&#39;, &#39;一&#39;, &#39;族&#39;, &#39;大&#39;, &#39;头&#39;, &#39;仔&#39;, &#39;大&#39;, &#39;家&#39;, &#39;团&#39;, &#39;结&#39;, &#39;一&#39;, &#39;致&#39;, &#39;，&#39;,
INFO:tensorflow:input_ids: [101, 1726, 1908, 3118, 2898, 8024, 6614, 2768, 8024, 1506, 1506, 5101, 1061, 1426, 1916, 1325, 1380, 6206, 4638, 7357, 2207, 1952, 672, 672, 2769, 4263, 2207, 5503, 5503, 671, 3184, 1920, 1928, 798, 
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 1
INFO:tensorflow:[&#39;剑&#39;, &#39;网&#39;, &#39;乱&#39;, &#39;世&#39;, &#39;长&#39;, &#39;安&#39;, &#39;公&#39;, &#39;测&#39;, &#39;盛&#39;, &#39;典&#39;, &#39;今&#39;, &#39;日&#39;, &#39;开&#39;, &#39;启&#39;, &#39;，&#39;, &#39;海&#39;, &#39;量&#39;, &#39;豪&#39;, &#39;礼&#39;, &#39;火&#39;, &#39;爆&#39;, &#39;开&#39;, &#39;送&#39;, &#39;精&#39;, &#39;美&#39;, &#39;挂&#39;, &#39;件&#39;, &#39;、&#39;, &#39;听&#39;, &#39;雨&#39;, &#39;·&#39;, &#39;汉&#39;, &#39;服&#39;, &#39;娃&#39;, &#39;娃&#39;, &#39;、&#39;, &#39;诙&#39;, &#39;谐&#39;, &#39;双&#39;, &#39;骑&#39;,
INFO:tensorflow:input_ids: [101, 1187, 5381, 744, 686, 7270, 2128, 1062, 3844, 4670, 1073, 791, 3189, 2458, 1423, 8024, 3862, 7030, 6498, 4851, 4125, 4255, 2458, 6843, 5125, 5401, 2899, 816, 510, 1420, 7433, 185, 3727, 3302, 20
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;在&#39;, &#39;街&#39;, &#39;上&#39;, &#39;听&#39;, &#39;见&#39;, &#39;音&#39;, &#39;乐&#39;, &#39;我&#39;, &#39;舞&#39;, &#39;动&#39;, &#39;起&#39;, &#39;来&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;？&#39;, &#39;真&#39;, &#39;的&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;吗&#39;, &#39;？&#39;]
INFO:tensorflow:input_ids: [101, 1762, 6125, 677, 1420, 6224, 7509, 727, 2769, 5659, 1220, 6629, 3341, 2523, 696, 782, 8043, 4696, 4638, 2523, 696, 782, 1408, 8043, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;三&#39;, &#39;毛&#39;, &#39;说&#39;, &#39;我&#39;, &#39;唯&#39;, &#39;一&#39;, &#39;锲&#39;, &#39;而&#39;, &#39;不&#39;, &#39;舍&#39;, &#39;，&#39;, &#39;愿&#39;, &#39;意&#39;, &#39;以&#39;, &#39;自&#39;, &#39;己&#39;, &#39;的&#39;, &#39;生&#39;, &#39;命&#39;, &#39;去&#39;, &#39;努&#39;, &#39;力&#39;, &#39;的&#39;, &#39;，&#39;, &#39;只&#39;, &#39;不&#39;, &#39;过&#39;, &#39;是&#39;, &#39;保&#39;, &#39;守&#39;, &#39;我&#39;, &#39;个&#39;, &#39;人&#39;, &#39;的&#39;, &#39;心&#39;, &#39;怀&#39;, &#39;意&#39;, &#39;念&#39;, &#39;，&#39;, &#39;在&#39;,
INFO:tensorflow:input_ids: [101, 676, 3688, 6432, 2769, 1546, 671, 7244, 5445, 679, 5650, 8024, 2703, 2692, 809, 5632, 2346, 4638, 4495, 1462, 1343, 1222, 1213, 4638, 8024, 1372, 679, 6814, 3221, 924, 2127, 2769, 702, 782, 4638
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_cls_label_ids: 1
INFO:tensorflow:[&#39;星&#39;, &#39;期&#39;, &#39;天&#39;, &#39;的&#39;, &#39;早&#39;, &#39;晨&#39;, &#39;七&#39;, &#39;点&#39;, &#39;学&#39;, &#39;车&#39;, &#39;，&#39;, &#39;驾&#39;, &#39;校&#39;, &#39;太&#39;, &#39;给&#39;, &#39;力&#39;, &#39;。&#39;, &#39;我&#39;, &#39;的&#39;, &#39;头&#39;, &#39;发&#39;, &#39;都&#39;, &#39;没&#39;, &#39;有&#39;, &#39;洗&#39;]
INFO:tensorflow:input_ids: [101, 3215, 3309, 1921, 4638, 3193, 3247, 673, 4157, 2110, 6756, 8024, 7730, 3413, 1922, 5314, 1213, 511, 2769, 4638, 1928, 1355, 6963, 3766, 3300, 3819, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;发&#39;, &#39;表&#39;, &#39;了&#39;, &#39;博&#39;, &#39;文&#39;, &#39;小&#39;, &#39;学&#39;, &#39;美&#39;, &#39;术&#39;, &#39;新&#39;, &#39;课&#39;, &#39;标&#39;, &#39;的&#39;, &#39;反&#39;, &#39;思&#39;, &#39;学&#39;, &#39;习&#39;, &#39;新&#39;, &#39;学&#39;, &#39;期&#39;, &#39;开&#39;, &#39;学&#39;, &#39;有&#39;, &#39;两&#39;, &#39;个&#39;, &#39;多&#39;, &#39;月&#39;, &#39;了&#39;, &#39;，&#39;, &#39;在&#39;, &#39;这&#39;, &#39;段&#39;, &#39;时&#39;, &#39;间&#39;, &#39;的&#39;, &#39;教&#39;, &#39;学&#39;, &#39;计&#39;, &#39;划&#39;, &#39;、&#39;,
INFO:tensorflow:input_ids: [101, 1355, 6134, 749, 1300, 3152, 2207, 2110, 5401, 3318, 3173, 6440, 3403, 4638, 1353, 2590, 2110, 739, 3173, 2110, 3309, 2458, 2110, 3300, 697, 702, 1914, 3299, 749, 8024, 1762, 6821, 3667, 3198, 7
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;镰&#39;, &#39;刀&#39;, &#39;刮&#39;, &#39;腋&#39;, &#39;毛&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;我&#39;, &#39;的&#39;, &#39;朋&#39;, &#39;友&#39;, &#39;是&#39;, &#39;个&#39;, &#39;呆&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;十&#39;, &#39;万&#39;, &#39;个&#39;,
INFO:tensorflow:input_ids: [101, 1506, 1506, 1506, 1506, 1506, 1506, 7266, 1143, 1167, 5573, 3688, 1506, 1506, 1506, 1506, 1506, 1506, 2769, 4638, 3301, 1351, 3221, 702, 1438, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 150
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_cls_label_ids: 1
INFO:tensorflow:[&#39;�&#39;, &#39;�&#39;, &#39;就&#39;, &#39;爱&#39;, &#39;这&#39;, &#39;个&#39;, &#39;牌&#39;, &#39;子&#39;, &#39;的&#39;, &#39;糖&#39;, &#39;果&#39;]
INFO:tensorflow:input_ids: [101, 2218, 4263, 6821, 702, 4277, 2094, 4638, 5131, 3362, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 0
INFO:tensorflow:[&#39;延&#39;, &#39;参&#39;, &#39;法&#39;, &#39;师&#39;, &#39;品&#39;, &#39;味&#39;, &#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;同&#39;, &#39;走&#39;, &#39;进&#39;, &#39;一&#39;, &#39;片&#39;, &#39;山&#39;, &#39;水&#39;, &#39;，&#39;, &#39;静&#39;, &#39;静&#39;, &#39;的&#39;, &#39;呼&#39;, &#39;吸&#39;, &#39;，&#39;, &#39;安&#39;, &#39;静&#39;, &#39;的&#39;, &#39;欣&#39;, &#39;赏&#39;, &#39;，&#39;, &#39;这&#39;, &#39;就&#39;, &#39;是&#39;, &#39;生&#39;, &#39;活&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 2454, 1346, 3791, 2360, 1501, 1456, 782, 4495, 1963, 1398, 6624, 6822, 671, 4275, 2255, 3717, 8024, 7474, 7474, 4638, 1461, 1429, 8024, 2128, 7474, 4638, 3615, 6605, 8024, 6821, 2218, 3221, 4495
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_cls_label_ids: 1
INFO:tensorflow:text: [&#39;科&#39;, &#39;技&#39;, &#39;全&#39;, &#39;方&#39;, &#39;位&#39;, &#39;资&#39;, &#39;讯&#39;, &#39;智&#39;, &#39;能&#39;, &#39;，&#39;, &#39;快&#39;, &#39;捷&#39;, &#39;的&#39;, &#39;汽&#39;, &#39;车&#39;, &#39;生&#39;, &#39;活&#39;, &#39;需&#39;, &#39;要&#39;, &#39;有&#39;, &#39;三&#39;, &#39;屏&#39;, &#39;一&#39;, &#39;云&#39;, &#39;爱&#39;, &#39;你&#39;]
INFO:tensorflow:image: [[0.44279893 0.67643493 0.74027443 0.95511823 0.39501776 0.8409984
  0.00345612 0.75463794 0.83498856 0.87825024]
 [0.67107134 0.2817143  0.75328324 0.10449435 0.9171996  0.13605994
  0.54965868 0.405
INFO:tensorflow:input_ids: [101, 4906, 2825, 1059, 3175, 855, 6598, 6380, 3255, 5543, 8024, 2571, 2949, 4638, 3749, 6756, 4495, 3833, 7444, 6206, 3300, 676, 2242, 671, 756, 4263, 872, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 0 0]
INFO:tensorflow:image_input: [[0.44279893 0.67643493 0.74027443 0.95511823 0.39501776 0.8409984
  0.00345612 0.75463794 0.83498856 0.87825024]
 [0.67107134 0.2817143  0.75328324 0.10449435 0.9171996  0.13605994
  0.54965868 0.405
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;对&#39;, &#39;，&#39;, &#39;输&#39;, &#39;给&#39;, &#39;一&#39;, &#39;个&#39;, &#39;女&#39;, &#39;人&#39;, &#39;，&#39;, &#39;的&#39;, &#39;成&#39;, &#39;绩&#39;, &#39;。&#39;, &#39;失&#39;, &#39;望&#39;]
INFO:tensorflow:image: [[0.82540804 0.73815102 0.83433611 0.48716374 0.97645137 0.00563871
  0.68611641 0.49145276 0.62380526 0.94496025]
 [0.16583495 0.11998949 0.56948907 0.54458899 0.29623737 0.30148478
  0.83217503 0.99
INFO:tensorflow:input_ids: [101, 2190, 8024, 6783, 5314, 671, 702, 1957, 782, 8024, 4638, 2768, 5327, 511, 1927, 3307, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 1]
INFO:tensorflow:image_input: [[0.82540804 0.73815102 0.83433611 0.48716374 0.97645137 0.00563871
  0.68611641 0.49145276 0.62380526 0.94496025]
 [0.16583495 0.11998949 0.56948907 0.54458899 0.29623737 0.30148478
  0.83217503 0.99
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;今&#39;, &#39;天&#39;, &#39;下&#39;, &#39;午&#39;, &#39;起&#39;, &#39;来&#39;, &#39;看&#39;, &#39;到&#39;, &#39;外&#39;, &#39;面&#39;, &#39;的&#39;, &#39;太&#39;, &#39;阳&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;我&#39;, &#39;第&#39;, &#39;一&#39;, &#39;反&#39;, &#39;应&#39;, &#39;竟&#39;, &#39;然&#39;, &#39;是&#39;, &#39;强&#39;, &#39;烈&#39;, &#39;的&#39;, &#39;想&#39;, &#39;回&#39;, &#39;家&#39;, &#39;泪&#39;, &#39;想&#39;, &#39;我&#39;, &#39;们&#39;, &#39;一&#39;, &#39;起&#39;, &#39;在&#39;, &#39;嘉&#39;, &#39;鱼&#39;,
INFO:tensorflow:image: [[0.59881985 0.68813644 0.20895843 0.92490018 0.53964891 0.68020218
  0.04693056 0.46082252 0.52603065 0.71716716]
 [0.67708203 0.29551686 0.92185177 0.92520592 0.78040666 0.24094991
  0.31442879 0.35
INFO:tensorflow:input_ids: [101, 791, 1921, 678, 1286, 6629, 3341, 4692, 1168, 1912, 7481, 4638, 1922, 7345, 511, 511, 511, 511, 2769, 5018, 671, 1353, 2418, 4994, 4197, 3221, 2487, 4164, 4638, 2682, 1726, 2157, 3801, 2682, 276
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 0]
INFO:tensorflow:image_input: [[0.59881985 0.68813644 0.20895843 0.92490018 0.53964891 0.68020218
  0.04693056 0.46082252 0.52603065 0.71716716]
 [0.67708203 0.29551686 0.92185177 0.92520592 0.78040666 0.24094991
  0.31442879 0.35
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;今&#39;, &#39;年&#39;, &#39;拜&#39;, &#39;年&#39;, &#39;不&#39;, &#39;短&#39;, &#39;信&#39;, &#39;，&#39;, &#39;就&#39;, &#39;在&#39;, &#39;微&#39;, &#39;博&#39;, &#39;拜&#39;, &#39;大&#39;, &#39;年&#39;, &#39;寻&#39;, &#39;龙&#39;, &#39;记&#39;]
INFO:tensorflow:image: [[0.08649038 0.36575778 0.89529804 0.03689921 0.9315774  0.23407946
  0.21909978 0.72173082 0.59005417 0.45124995]
 [0.66130387 0.82041658 0.78665033 0.89873076 0.88122194 0.90244137
  0.48413739 0.50
INFO:tensorflow:input_ids: [101, 791, 2399, 2876, 2399, 679, 4764, 928, 8024, 2218, 1762, 2544, 1300, 2876, 1920, 2399, 2192, 7987, 6381, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 0 0]
INFO:tensorflow:image_input: [[0.08649038 0.36575778 0.89529804 0.03689921 0.9315774  0.23407946
  0.21909978 0.72173082 0.59005417 0.45124995]
 [0.66130387 0.82041658 0.78665033 0.89873076 0.88122194 0.90244137
  0.48413739 0.50
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;浑&#39;, &#39;身&#39;, &#39;酸&#39;, &#39;疼&#39;, &#39;，&#39;, &#39;两&#39;, &#39;腿&#39;, &#39;无&#39;, &#39;力&#39;, &#39;，&#39;, &#39;眼&#39;, &#39;神&#39;, &#39;呆&#39;, &#39;滞&#39;, &#39;，&#39;, &#39;怎&#39;, &#39;么&#39;, &#39;了&#39;]
INFO:tensorflow:image: [[0.11080887 0.23191078 0.5146572  0.15434347 0.57321658 0.97020126
  0.17439633 0.94329804 0.19877997 0.86765119]
 [0.98156348 0.82997141 0.99370052 0.23598963 0.27613302 0.64150907
  0.76234803 0.31
INFO:tensorflow:input_ids: [101, 3847, 6716, 7000, 4563, 8024, 697, 5597, 3187, 1213, 8024, 4706, 4868, 1438, 4005, 8024, 2582, 720, 749, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 0]
INFO:tensorflow:image_input: [[0.11080887 0.23191078 0.5146572  0.15434347 0.57321658 0.97020126
  0.17439633 0.94329804 0.19877997 0.86765119]
 [0.98156348 0.82997141 0.99370052 0.23598963 0.27613302 0.64150907
  0.76234803 0.31
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;明&#39;, &#39;显&#39;, &#39;紧&#39;, &#39;张&#39;, &#39;状&#39;, &#39;态&#39;, &#39;没&#39;, &#39;出&#39;, &#39;来&#39;, &#39;，&#39;, &#39;失&#39;, &#39;误&#39;, &#39;多&#39;, &#39;。&#39;]
INFO:tensorflow:image: [[0.18685083 0.17124633 0.8651     0.85963833 0.075413   0.56493724
  0.06035638 0.35056794 0.58816613 0.87263169]
 [0.76128775 0.69623433 0.83820068 0.80574306 0.59613579 0.20980418
  0.99623407 0.43
INFO:tensorflow:input_ids: [101, 3209, 3227, 5165, 2476, 4307, 2578, 3766, 1139, 3341, 8024, 1927, 6428, 1914, 511, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 0 0]
INFO:tensorflow:image_input: [[0.18685083 0.17124633 0.8651     0.85963833 0.075413   0.56493724
  0.06035638 0.35056794 0.58816613 0.87263169]
 [0.76128775 0.69623433 0.83820068 0.80574306 0.59613579 0.20980418
  0.99623407 0.43
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;三&#39;, &#39;十&#39;, &#39;年&#39;, &#39;前&#39;, &#39;，&#39;, &#39;老&#39;, &#39;爹&#39;, &#39;带&#39;, &#39;我&#39;, &#39;来&#39;, &#39;这&#39;, &#39;里&#39;, &#39;开&#39;, &#39;会&#39;, &#39;，&#39;, &#39;今&#39;, &#39;天&#39;, &#39;打&#39;, &#39;了&#39;, &#39;个&#39;, &#39;颠&#39;, &#39;倒&#39;, &#39;。&#39;, &#39;我&#39;, &#39;在&#39;, &#39;这&#39;, &#39;里&#39;]
INFO:tensorflow:image: [[0.08222987 0.35598899 0.48556919 0.1160639  0.80908458 0.79018335
  0.90560816 0.25663494 0.44177912 0.92083187]
 [0.62320172 0.47230908 0.53542499 0.85287882 0.72865666 0.64756321
  0.63534153 0.69
INFO:tensorflow:input_ids: [101, 676, 1282, 2399, 1184, 8024, 5439, 4269, 2372, 2769, 3341, 6821, 7027, 2458, 833, 8024, 791, 1921, 2802, 749, 702, 7585, 948, 511, 2769, 1762, 6821, 7027, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 1]
INFO:tensorflow:image_input: [[0.08222987 0.35598899 0.48556919 0.1160639  0.80908458 0.79018335
  0.90560816 0.25663494 0.44177912 0.92083187]
 [0.62320172 0.47230908 0.53542499 0.85287882 0.72865666 0.64756321
  0.63534153 0.69
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;好&#39;, &#39;活&#39;, &#39;动&#39;, &#39;呀&#39;, &#39;，&#39;, &#39;给&#39;, &#39;力&#39;, &#39;的&#39;, &#39;商&#39;, &#39;家&#39;, &#39;，&#39;, &#39;必&#39;, &#39;须&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;希&#39;, &#39;望&#39;, &#39;以&#39;, &#39;后&#39;, &#39;多&#39;, &#39;多&#39;, &#39;办&#39;, &#39;活&#39;, &#39;动&#39;, &#39;跟&#39;, &#39;我&#39;, &#39;们&#39;, &#39;互&#39;, &#39;动&#39;, &#39;哈&#39;, &#39;巧&#39;, &#39;慧&#39;, &#39;铣&#39;]
INFO:tensorflow:image: [[0.17822633 0.39794771 0.23567817 0.02074661 0.21612564 0.50878125
  0.32494113 0.34853523 0.16998522 0.78693213]
 [0.85022977 0.69379671 0.04994448 0.93649146 0.87250807 0.96205852
  0.86360374 0.75
INFO:tensorflow:input_ids: [101, 1962, 3833, 1220, 1435, 8024, 5314, 1213, 4638, 1555, 2157, 8024, 2553, 7557, 3118, 2898, 8024, 2361, 3307, 809, 1400, 1914, 1914, 1215, 3833, 1220, 6656, 2769, 812, 757, 1220, 1506, 2341, 2716,
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [0 0 0]
INFO:tensorflow:image_input: [[0.17822633 0.39794771 0.23567817 0.02074661 0.21612564 0.50878125
  0.32494113 0.34853523 0.16998522 0.78693213]
 [0.85022977 0.69379671 0.04994448 0.93649146 0.87250807 0.96205852
  0.86360374 0.75
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;戏&#39;, &#39;，&#39;, &#39;导&#39;, &#39;演&#39;, &#39;是&#39;, &#39;自&#39;, &#39;己&#39;, &#39;蜡&#39;, &#39;烛&#39;]
INFO:tensorflow:image: [[0.0304071  0.41116726 0.69394864 0.15428762 0.99249552 0.78048454
  0.271264   0.27568994 0.46965997 0.44208467]
 [0.80091245 0.65670791 0.44584884 0.3784151  0.81696811 0.23784869
  0.12026526 0.46
INFO:tensorflow:input_ids: [101, 782, 4495, 1963, 2767, 8024, 2193, 4028, 3221, 5632, 2346, 6058, 4169, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 0]
INFO:tensorflow:image_input: [[0.0304071  0.41116726 0.69394864 0.15428762 0.99249552 0.78048454
  0.271264   0.27568994 0.46965997 0.44208467]
 [0.80091245 0.65670791 0.44584884 0.3784151  0.81696811 0.23784869
  0.12026526 0.46
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;听&#39;, &#39;说&#39;, &#39;小&#39;, &#39;米&#39;, &#39;开&#39;, &#39;卖&#39;, &#39;了&#39;, &#39;，&#39;, &#39;刚&#39;, &#39;刚&#39;, &#39;预&#39;, &#39;约&#39;, &#39;了&#39;, &#39;台&#39;, &#39;。&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;因&#39;, &#39;为&#39;, &#39;他&#39;, &#39;是&#39;, &#39;迄&#39;, &#39;今&#39;, &#39;为&#39;, &#39;止&#39;, &#39;最&#39;, &#39;快&#39;, &#39;的&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;月&#39;, &#39;日&#39;, &#39;中&#39;, &#39;午&#39;,
INFO:tensorflow:image: [[0.76297728 0.75915466 0.12470514 0.63529986 0.08460564 0.19707048
  0.76679787 0.67805186 0.57008664 0.52433096]
 [0.58690055 0.62056809 0.45058247 0.06544871 0.08878304 0.83669307
  0.8312114  0.85
INFO:tensorflow:input_ids: [101, 1420, 6432, 2207, 5101, 2458, 1297, 749, 8024, 1157, 1157, 7564, 5276, 749, 1378, 511, 2769, 4263, 2207, 5101, 2797, 3322, 1728, 711, 800, 3221, 6812, 791, 711, 3632, 3297, 2571, 4638, 2207, 510
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [0 0 0]
INFO:tensorflow:image_input: [[0.76297728 0.75915466 0.12470514 0.63529986 0.08460564 0.19707048
  0.76679787 0.67805186 0.57008664 0.52433096]
 [0.58690055 0.62056809 0.45058247 0.06544871 0.08878304 0.83669307
  0.8312114  0.85
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;一&#39;, &#39;节&#39;, &#39;课&#39;, &#39;的&#39;, &#39;时&#39;, &#39;间&#39;, &#39;真&#39;, &#39;心&#39;, &#39;感&#39;, &#39;动&#39;, &#39;了&#39;, &#39;李&#39;, &#39;开&#39;, &#39;复&#39;, &#39;感&#39;, &#39;动&#39;]
INFO:tensorflow:image: [[0.90056963 0.73479469 0.06643312 0.92194781 0.0055938  0.52454225
  0.4204001  0.10034613 0.2992046  0.81026468]
 [0.56939568 0.98242695 0.8693748  0.71250602 0.96559423 0.91753442
  0.72355334 0.96
INFO:tensorflow:input_ids: [101, 671, 5688, 6440, 4638, 3198, 7313, 4696, 2552, 2697, 1220, 749, 3330, 2458, 1908, 2697, 1220, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 0]
INFO:tensorflow:image_input: [[0.90056963 0.73479469 0.06643312 0.92194781 0.0055938  0.52454225
  0.4204001  0.10034613 0.2992046  0.81026468]
 [0.56939568 0.98242695 0.8693748  0.71250602 0.96559423 0.91753442
  0.72355334 0.96
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;回&#39;, &#39;复&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;赞&#39;, &#39;成&#39;, &#39;，&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;米&#39;, &#39;八&#39;, &#39;吴&#39;, &#39;够&#39;, &#39;历&#39;, &#39;史&#39;, &#39;要&#39;, &#39;的&#39;, &#39;陈&#39;, &#39;小&#39;, &#39;奥&#39;, &#39;丁&#39;, &#39;丁&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;肥&#39;, &#39;肥&#39;, &#39;一&#39;, &#39;族&#39;, &#39;大&#39;, &#39;头&#39;, &#39;仔&#39;, &#39;大&#39;, &#39;家&#39;, &#39;团&#39;, &#39;结&#39;, &#39;一&#39;, &#39;致&#39;, &#39;，&#39;,
INFO:tensorflow:image: [[0.98991319 0.023818   0.17414589 0.40646716 0.1927037  0.71080925
  0.09947213 0.37895587 0.41223157 0.78459389]
 [0.2425995  0.61173087 0.1808322  0.31604618 0.02926707 0.72955527
  0.1308583  0.98
INFO:tensorflow:input_ids: [101, 1726, 1908, 3118, 2898, 8024, 6614, 2768, 8024, 1506, 1506, 5101, 1061, 1426, 1916, 1325, 1380, 6206, 4638, 7357, 2207, 1952, 672, 672, 2769, 4263, 2207, 5503, 5503, 671, 3184, 1920, 1928, 798, 
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 0 0]
INFO:tensorflow:image_input: [[0.98991319 0.023818   0.17414589 0.40646716 0.1927037  0.71080925
  0.09947213 0.37895587 0.41223157 0.78459389]
 [0.2425995  0.61173087 0.1808322  0.31604618 0.02926707 0.72955527
  0.1308583  0.98
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;剑&#39;, &#39;网&#39;, &#39;乱&#39;, &#39;世&#39;, &#39;长&#39;, &#39;安&#39;, &#39;公&#39;, &#39;测&#39;, &#39;盛&#39;, &#39;典&#39;, &#39;今&#39;, &#39;日&#39;, &#39;开&#39;, &#39;启&#39;, &#39;，&#39;, &#39;海&#39;, &#39;量&#39;, &#39;豪&#39;, &#39;礼&#39;, &#39;火&#39;, &#39;爆&#39;, &#39;开&#39;, &#39;送&#39;, &#39;精&#39;, &#39;美&#39;, &#39;挂&#39;, &#39;件&#39;, &#39;、&#39;, &#39;听&#39;, &#39;雨&#39;, &#39;·&#39;, &#39;汉&#39;, &#39;服&#39;, &#39;娃&#39;, &#39;娃&#39;, &#39;、&#39;, &#39;诙&#39;, &#39;谐&#39;, &#39;双&#39;, &#39;骑&#39;,
INFO:tensorflow:image: [[0.02582166 0.98060919 0.84245735 0.50966105 0.7174172  0.79153291
  0.71287955 0.57463577 0.68371743 0.6825486 ]
 [0.70281043 0.54113289 0.09771392 0.7831093  0.84598776 0.21987748
  0.79864102 0.79
INFO:tensorflow:input_ids: [101, 1187, 5381, 744, 686, 7270, 2128, 1062, 3844, 4670, 1073, 791, 3189, 2458, 1423, 8024, 3862, 7030, 6498, 4851, 4125, 4255, 2458, 6843, 5125, 5401, 2899, 816, 510, 1420, 7433, 185, 3727, 3302, 20
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 0]
INFO:tensorflow:image_input: [[0.02582166 0.98060919 0.84245735 0.50966105 0.7174172  0.79153291
  0.71287955 0.57463577 0.68371743 0.6825486 ]
 [0.70281043 0.54113289 0.09771392 0.7831093  0.84598776 0.21987748
  0.79864102 0.79
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;在&#39;, &#39;街&#39;, &#39;上&#39;, &#39;听&#39;, &#39;见&#39;, &#39;音&#39;, &#39;乐&#39;, &#39;我&#39;, &#39;舞&#39;, &#39;动&#39;, &#39;起&#39;, &#39;来&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;？&#39;, &#39;真&#39;, &#39;的&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;吗&#39;, &#39;？&#39;]
INFO:tensorflow:image: [[0.38364011 0.70251055 0.72552332 0.13049419 0.34205453 0.00122181
  0.26945376 0.99876405 0.13231536 0.48913623]
 [0.14247461 0.4617301  0.42518213 0.7280603  0.66858313 0.57078418
  0.8131848  0.72
INFO:tensorflow:input_ids: [101, 1762, 6125, 677, 1420, 6224, 7509, 727, 2769, 5659, 1220, 6629, 3341, 2523, 696, 782, 8043, 4696, 4638, 2523, 696, 782, 1408, 8043, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 1]
INFO:tensorflow:image_input: [[0.38364011 0.70251055 0.72552332 0.13049419 0.34205453 0.00122181
  0.26945376 0.99876405 0.13231536 0.48913623]
 [0.14247461 0.4617301  0.42518213 0.7280603  0.66858313 0.57078418
  0.8131848  0.72
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;三&#39;, &#39;毛&#39;, &#39;说&#39;, &#39;我&#39;, &#39;唯&#39;, &#39;一&#39;, &#39;锲&#39;, &#39;而&#39;, &#39;不&#39;, &#39;舍&#39;, &#39;，&#39;, &#39;愿&#39;, &#39;意&#39;, &#39;以&#39;, &#39;自&#39;, &#39;己&#39;, &#39;的&#39;, &#39;生&#39;, &#39;命&#39;, &#39;去&#39;, &#39;努&#39;, &#39;力&#39;, &#39;的&#39;, &#39;，&#39;, &#39;只&#39;, &#39;不&#39;, &#39;过&#39;, &#39;是&#39;, &#39;保&#39;, &#39;守&#39;, &#39;我&#39;, &#39;个&#39;, &#39;人&#39;, &#39;的&#39;, &#39;心&#39;, &#39;怀&#39;, &#39;意&#39;, &#39;念&#39;, &#39;，&#39;, &#39;在&#39;,
INFO:tensorflow:image: [[0.41223478 0.24231557 0.56160683 0.35674031 0.1735271  0.0454199
  0.54501127 0.70948689 0.33310327 0.6749974 ]
 [0.14587951 0.40586653 0.24085796 0.3914189  0.35447707 0.52987637
  0.70579896 0.061
INFO:tensorflow:input_ids: [101, 676, 3688, 6432, 2769, 1546, 671, 7244, 5445, 679, 5650, 8024, 2703, 2692, 809, 5632, 2346, 4638, 4495, 1462, 1343, 1222, 1213, 4638, 8024, 1372, 679, 6814, 3221, 924, 2127, 2769, 702, 782, 4638
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [0 0 0]
INFO:tensorflow:image_input: [[0.41223478 0.24231557 0.56160683 0.35674031 0.1735271  0.0454199
  0.54501127 0.70948689 0.33310327 0.6749974 ]
 [0.14587951 0.40586653 0.24085796 0.3914189  0.35447707 0.52987637
  0.70579896 0.061
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;星&#39;, &#39;期&#39;, &#39;天&#39;, &#39;的&#39;, &#39;早&#39;, &#39;晨&#39;, &#39;七&#39;, &#39;点&#39;, &#39;学&#39;, &#39;车&#39;, &#39;，&#39;, &#39;驾&#39;, &#39;校&#39;, &#39;太&#39;, &#39;给&#39;, &#39;力&#39;, &#39;。&#39;, &#39;我&#39;, &#39;的&#39;, &#39;头&#39;, &#39;发&#39;, &#39;都&#39;, &#39;没&#39;, &#39;有&#39;, &#39;洗&#39;]
INFO:tensorflow:image: [[0.00623847 0.33684781 0.9817899  0.0788222  0.33589331 0.30484615
  0.27228461 0.31543927 0.38149035 0.06027291]
 [0.98470742 0.32946272 0.3649427  0.92033886 0.38998517 0.76482647
  0.05941081 0.34
INFO:tensorflow:input_ids: [101, 3215, 3309, 1921, 4638, 3193, 3247, 673, 4157, 2110, 6756, 8024, 7730, 3413, 1922, 5314, 1213, 511, 2769, 4638, 1928, 1355, 6963, 3766, 3300, 3819, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 0 0]
INFO:tensorflow:image_input: [[0.00623847 0.33684781 0.9817899  0.0788222  0.33589331 0.30484615
  0.27228461 0.31543927 0.38149035 0.06027291]
 [0.98470742 0.32946272 0.3649427  0.92033886 0.38998517 0.76482647
  0.05941081 0.34
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;发&#39;, &#39;表&#39;, &#39;了&#39;, &#39;博&#39;, &#39;文&#39;, &#39;小&#39;, &#39;学&#39;, &#39;美&#39;, &#39;术&#39;, &#39;新&#39;, &#39;课&#39;, &#39;标&#39;, &#39;的&#39;, &#39;反&#39;, &#39;思&#39;, &#39;学&#39;, &#39;习&#39;, &#39;新&#39;, &#39;学&#39;, &#39;期&#39;, &#39;开&#39;, &#39;学&#39;, &#39;有&#39;, &#39;两&#39;, &#39;个&#39;, &#39;多&#39;, &#39;月&#39;, &#39;了&#39;, &#39;，&#39;, &#39;在&#39;, &#39;这&#39;, &#39;段&#39;, &#39;时&#39;, &#39;间&#39;, &#39;的&#39;, &#39;教&#39;, &#39;学&#39;, &#39;计&#39;, &#39;划&#39;, &#39;、&#39;,
INFO:tensorflow:image: [[0.93157916 0.98155867 0.21047231 0.28575073 0.14966477 0.51908592
  0.53908487 0.69237549 0.37724614 0.16960179]
 [0.19353987 0.99894709 0.56347355 0.7816188  0.52015073 0.56157799
  0.18808036 0.38
INFO:tensorflow:input_ids: [101, 1355, 6134, 749, 1300, 3152, 2207, 2110, 5401, 3318, 3173, 6440, 3403, 4638, 1353, 2590, 2110, 739, 3173, 2110, 3309, 2458, 2110, 3300, 697, 702, 1914, 3299, 749, 8024, 1762, 6821, 3667, 3198, 7
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 0 0]
INFO:tensorflow:image_input: [[0.93157916 0.98155867 0.21047231 0.28575073 0.14966477 0.51908592
  0.53908487 0.69237549 0.37724614 0.16960179]
 [0.19353987 0.99894709 0.56347355 0.7816188  0.52015073 0.56157799
  0.18808036 0.38
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;镰&#39;, &#39;刀&#39;, &#39;刮&#39;, &#39;腋&#39;, &#39;毛&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;我&#39;, &#39;的&#39;, &#39;朋&#39;, &#39;友&#39;, &#39;是&#39;, &#39;个&#39;, &#39;呆&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;十&#39;, &#39;万&#39;, &#39;个&#39;,
INFO:tensorflow:image: [[0.38878117 0.81346306 0.7450282  0.03280803 0.20033701 0.36849916
  0.54316381 0.17722489 0.36008834 0.13706087]
 [0.07152476 0.55354473 0.44746832 0.07619977 0.80318116 0.2066631
  0.05530096 0.458
INFO:tensorflow:input_ids: [101, 1506, 1506, 1506, 1506, 1506, 1506, 7266, 1143, 1167, 5573, 3688, 1506, 1506, 1506, 1506, 1506, 1506, 2769, 4638, 3301, 1351, 3221, 702, 1438, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 150
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [0 0 0]
INFO:tensorflow:image_input: [[0.38878117 0.81346306 0.7450282  0.03280803 0.20033701 0.36849916
  0.54316381 0.17722489 0.36008834 0.13706087]
 [0.07152476 0.55354473 0.44746832 0.07619977 0.80318116 0.2066631
  0.05530096 0.458
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;�&#39;, &#39;�&#39;, &#39;就&#39;, &#39;爱&#39;, &#39;这&#39;, &#39;个&#39;, &#39;牌&#39;, &#39;子&#39;, &#39;的&#39;, &#39;糖&#39;, &#39;果&#39;]
INFO:tensorflow:image: [[0.62515917 0.52398882 0.30890055 0.2505593  0.49265949 0.12569459
  0.80317811 0.45612944 0.92294932 0.16454635]
 [0.16250531 0.75415437 0.49463    0.24069082 0.39571273 0.3429164
  0.77442902 0.805
INFO:tensorflow:input_ids: [101, 2218, 4263, 6821, 702, 4277, 2094, 4638, 5131, 3362, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 1]
INFO:tensorflow:image_input: [[0.62515917 0.52398882 0.30890055 0.2505593  0.49265949 0.12569459
  0.80317811 0.45612944 0.92294932 0.16454635]
 [0.16250531 0.75415437 0.49463    0.24069082 0.39571273 0.3429164
  0.77442902 0.805
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:text: [&#39;延&#39;, &#39;参&#39;, &#39;法&#39;, &#39;师&#39;, &#39;品&#39;, &#39;味&#39;, &#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;同&#39;, &#39;走&#39;, &#39;进&#39;, &#39;一&#39;, &#39;片&#39;, &#39;山&#39;, &#39;水&#39;, &#39;，&#39;, &#39;静&#39;, &#39;静&#39;, &#39;的&#39;, &#39;呼&#39;, &#39;吸&#39;, &#39;，&#39;, &#39;安&#39;, &#39;静&#39;, &#39;的&#39;, &#39;欣&#39;, &#39;赏&#39;, &#39;，&#39;, &#39;这&#39;, &#39;就&#39;, &#39;是&#39;, &#39;生&#39;, &#39;活&#39;, &#39;。&#39;]
INFO:tensorflow:image: [[0.40022407 0.6537021  0.51528257 0.21634349 0.693887   0.14274998
  0.71362183 0.37336532 0.31090585 0.33944523]
 [0.4914146  0.15448976 0.64700368 0.24131104 0.68573365 0.10067735
  0.26450457 0.56
INFO:tensorflow:input_ids: [101, 2454, 1346, 3791, 2360, 1501, 1456, 782, 4495, 1963, 1398, 6624, 6822, 671, 4275, 2255, 3717, 8024, 7474, 7474, 4638, 1461, 1429, 8024, 2128, 7474, 4638, 3615, 6605, 8024, 6821, 2218, 3221, 4495
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:weibo_fake_multi_cls_label_ids: [1 1 0]
INFO:tensorflow:image_input: [[0.40022407 0.6537021  0.51528257 0.21634349 0.693887   0.14274998
  0.71362183 0.37336532 0.31090585 0.33944523]
 [0.4914146  0.15448976 0.64700368 0.24131104 0.68573365 0.10067735
  0.26450457 0.56
INFO:tensorflow:image_mask: [1, 1, 1, 1, 1]
INFO:tensorflow:image_segment_ids: [0 0 0 0 0]
INFO:tensorflow:[&#39;对&#39;, &#39;，&#39;, &#39;输&#39;, &#39;给&#39;, &#39;一&#39;, &#39;个&#39;, &#39;女&#39;, &#39;人&#39;, &#39;，&#39;, &#39;的&#39;, &#39;成&#39;, &#39;绩&#39;, &#39;。&#39;, &#39;失&#39;, &#39;望&#39;]
INFO:tensorflow:input_ids: [101, 2190, 8024, 6783, 5314, 671, 702, 1957, 782, 103, 4638, 2768, 5327, 511, 1927, 3307, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [8024    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;今&#39;, &#39;天&#39;, &#39;下&#39;, &#39;午&#39;, &#39;起&#39;, &#39;来&#39;, &#39;看&#39;, &#39;到&#39;, &#39;外&#39;, &#39;面&#39;, &#39;的&#39;, &#39;太&#39;, &#39;阳&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;。&#39;, &#39;我&#39;, &#39;第&#39;, &#39;一&#39;, &#39;反&#39;, &#39;应&#39;, &#39;竟&#39;, &#39;然&#39;, &#39;是&#39;, &#39;强&#39;, &#39;烈&#39;, &#39;的&#39;, &#39;想&#39;, &#39;回&#39;, &#39;家&#39;, &#39;泪&#39;, &#39;想&#39;, &#39;我&#39;, &#39;们&#39;, &#39;一&#39;, &#39;起&#39;, &#39;在&#39;, &#39;嘉&#39;, &#39;鱼&#39;,
INFO:tensorflow:input_ids: [101, 103, 1921, 103, 1286, 6629, 3341, 4692, 1168, 103, 7481, 4638, 1922, 7345, 511, 511, 511, 511, 2769, 5018, 671, 1353, 103, 4994, 4197, 3221, 2487, 4164, 103, 2682, 1726, 2157, 3801, 2682, 2769, 
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [1, 3, 9, 22, 28, 39, 44, 49, 55, 58, 70, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [ 791  678 1912 2418 4638 1649  749 3300 6413  872 2359    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;今&#39;, &#39;年&#39;, &#39;拜&#39;, &#39;年&#39;, &#39;不&#39;, &#39;短&#39;, &#39;信&#39;, &#39;，&#39;, &#39;就&#39;, &#39;在&#39;, &#39;微&#39;, &#39;博&#39;, &#39;拜&#39;, &#39;大&#39;, &#39;年&#39;, &#39;寻&#39;, &#39;龙&#39;, &#39;记&#39;]
INFO:tensorflow:input_ids: [101, 791, 2399, 2876, 2399, 679, 4764, 928, 103, 2218, 1762, 2544, 1300, 2876, 1920, 2399, 2192, 7987, 6381, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [8024    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;浑&#39;, &#39;身&#39;, &#39;酸&#39;, &#39;疼&#39;, &#39;，&#39;, &#39;两&#39;, &#39;腿&#39;, &#39;无&#39;, &#39;力&#39;, &#39;，&#39;, &#39;眼&#39;, &#39;神&#39;, &#39;呆&#39;, &#39;滞&#39;, &#39;，&#39;, &#39;怎&#39;, &#39;么&#39;, &#39;了&#39;]
INFO:tensorflow:input_ids: [101, 3847, 6716, 7000, 4563, 8024, 103, 5597, 3187, 1213, 8024, 4706, 4868, 1438, 4005, 8024, 2582, 720, 749, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [697   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   0   0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;明&#39;, &#39;显&#39;, &#39;紧&#39;, &#39;张&#39;, &#39;状&#39;, &#39;态&#39;, &#39;没&#39;, &#39;出&#39;, &#39;来&#39;, &#39;，&#39;, &#39;失&#39;, &#39;误&#39;, &#39;多&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 3209, 3227, 5165, 2476, 4307, 2578, 103, 103, 3341, 8024, 103, 6428, 1914, 511, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [7, 8, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [3766 1139 1927    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;三&#39;, &#39;十&#39;, &#39;年&#39;, &#39;前&#39;, &#39;，&#39;, &#39;老&#39;, &#39;爹&#39;, &#39;带&#39;, &#39;我&#39;, &#39;来&#39;, &#39;这&#39;, &#39;里&#39;, &#39;开&#39;, &#39;会&#39;, &#39;，&#39;, &#39;今&#39;, &#39;天&#39;, &#39;打&#39;, &#39;了&#39;, &#39;个&#39;, &#39;颠&#39;, &#39;倒&#39;, &#39;。&#39;, &#39;我&#39;, &#39;在&#39;, &#39;这&#39;, &#39;里&#39;]
INFO:tensorflow:input_ids: [101, 676, 1282, 2399, 103, 8024, 103, 4269, 2372, 2769, 3341, 6821, 7027, 2458, 833, 8024, 791, 1921, 2802, 749, 702, 7585, 948, 511, 103, 1762, 6821, 7027, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [4, 6, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1184 5439 2769    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;好&#39;, &#39;活&#39;, &#39;动&#39;, &#39;呀&#39;, &#39;，&#39;, &#39;给&#39;, &#39;力&#39;, &#39;的&#39;, &#39;商&#39;, &#39;家&#39;, &#39;，&#39;, &#39;必&#39;, &#39;须&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;希&#39;, &#39;望&#39;, &#39;以&#39;, &#39;后&#39;, &#39;多&#39;, &#39;多&#39;, &#39;办&#39;, &#39;活&#39;, &#39;动&#39;, &#39;跟&#39;, &#39;我&#39;, &#39;们&#39;, &#39;互&#39;, &#39;动&#39;, &#39;哈&#39;, &#39;巧&#39;, &#39;慧&#39;, &#39;铣&#39;]
INFO:tensorflow:input_ids: [101, 1962, 3833, 1220, 1435, 103, 5314, 1213, 4638, 103, 2157, 8024, 2553, 7557, 3118, 2898, 8024, 103, 3307, 809, 1400, 103, 1914, 1215, 3833, 1220, 6656, 2769, 812, 757, 1220, 1506, 2341, 2716, 720
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [5, 9, 17, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [8024 1555 2361 1914    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;戏&#39;, &#39;，&#39;, &#39;导&#39;, &#39;演&#39;, &#39;是&#39;, &#39;自&#39;, &#39;己&#39;, &#39;蜡&#39;, &#39;烛&#39;]
INFO:tensorflow:input_ids: [101, 782, 4495, 1963, 103, 8024, 2193, 4028, 3221, 5632, 2346, 6058, 4169, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [2767    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;听&#39;, &#39;说&#39;, &#39;小&#39;, &#39;米&#39;, &#39;开&#39;, &#39;卖&#39;, &#39;了&#39;, &#39;，&#39;, &#39;刚&#39;, &#39;刚&#39;, &#39;预&#39;, &#39;约&#39;, &#39;了&#39;, &#39;台&#39;, &#39;。&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;因&#39;, &#39;为&#39;, &#39;他&#39;, &#39;是&#39;, &#39;迄&#39;, &#39;今&#39;, &#39;为&#39;, &#39;止&#39;, &#39;最&#39;, &#39;快&#39;, &#39;的&#39;, &#39;小&#39;, &#39;米&#39;, &#39;手&#39;, &#39;机&#39;, &#39;月&#39;, &#39;日&#39;, &#39;中&#39;, &#39;午&#39;,
INFO:tensorflow:input_ids: [101, 1420, 6432, 2207, 5101, 2458, 1297, 749, 8024, 1157, 103, 7564, 5276, 103, 1378, 511, 2769, 4263, 2207, 5101, 2797, 3322, 1728, 103, 800, 3221, 6812, 103, 711, 3632, 3297, 2571, 4638, 2207, 5101
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [10, 13, 23, 27, 39, 51, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1157  749  711  791  704 2207    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;最&#39;, &#39;热&#39;, &#39;时&#39;, &#39;尚&#39;, &#39;榜&#39;, &#39;女&#39;, &#39;人&#39;, &#39;不&#39;, &#39;坏&#39;, &#39;，&#39;, &#39;男&#39;, &#39;人&#39;, &#39;不&#39;, &#39;爱&#39;, &#39;，&#39;, &#39;一&#39;, &#39;个&#39;, &#39;男&#39;, &#39;女&#39;, &#39;必&#39;, &#39;看&#39;, &#39;的&#39;, &#39;微&#39;, &#39;博&#39;, &#39;花&#39;, &#39;心&#39;]
INFO:tensorflow:input_ids: [101, 3297, 4178, 3198, 103, 103, 1957, 782, 679, 103, 8024, 4511, 103, 679, 4263, 8024, 671, 702, 4511, 1957, 2553, 103, 4638, 2544, 1300, 5709, 2552, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [4, 5, 9, 12, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [2213 3528 1776  782 4692    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;回&#39;, &#39;复&#39;, &#39;支&#39;, &#39;持&#39;, &#39;，&#39;, &#39;赞&#39;, &#39;成&#39;, &#39;，&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;米&#39;, &#39;八&#39;, &#39;吴&#39;, &#39;够&#39;, &#39;历&#39;, &#39;史&#39;, &#39;要&#39;, &#39;的&#39;, &#39;陈&#39;, &#39;小&#39;, &#39;奥&#39;, &#39;丁&#39;, &#39;丁&#39;, &#39;我&#39;, &#39;爱&#39;, &#39;小&#39;, &#39;肥&#39;, &#39;肥&#39;, &#39;一&#39;, &#39;族&#39;, &#39;大&#39;, &#39;头&#39;, &#39;仔&#39;, &#39;大&#39;, &#39;家&#39;, &#39;团&#39;, &#39;结&#39;, &#39;一&#39;, &#39;致&#39;, &#39;，&#39;,
INFO:tensorflow:input_ids: [101, 1726, 1908, 3118, 2898, 8024, 6614, 2768, 8024, 1506, 1506, 5101, 1061, 1426, 1916, 1325, 1380, 6206, 4638, 103, 2207, 1952, 103, 103, 2769, 4263, 2207, 5503, 103, 671, 3184, 103, 1928, 798, 192
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [19, 22, 23, 28, 31, 35, 37, 40, 42, 44, 45, 54, 57, 59, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [7357  672  672 5503 1920 2157 5310 8024 6206 1378 3968 1730 1213 1920
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0]
INFO:tensorflow:[&#39;剑&#39;, &#39;网&#39;, &#39;乱&#39;, &#39;世&#39;, &#39;长&#39;, &#39;安&#39;, &#39;公&#39;, &#39;测&#39;, &#39;盛&#39;, &#39;典&#39;, &#39;今&#39;, &#39;日&#39;, &#39;开&#39;, &#39;启&#39;, &#39;，&#39;, &#39;海&#39;, &#39;量&#39;, &#39;豪&#39;, &#39;礼&#39;, &#39;火&#39;, &#39;爆&#39;, &#39;开&#39;, &#39;送&#39;, &#39;精&#39;, &#39;美&#39;, &#39;挂&#39;, &#39;件&#39;, &#39;、&#39;, &#39;听&#39;, &#39;雨&#39;, &#39;·&#39;, &#39;汉&#39;, &#39;服&#39;, &#39;娃&#39;, &#39;娃&#39;, &#39;、&#39;, &#39;诙&#39;, &#39;谐&#39;, &#39;双&#39;, &#39;骑&#39;,
INFO:tensorflow:input_ids: [101, 1187, 5381, 744, 686, 7270, 2128, 103, 3844, 4670, 1073, 791, 3189, 2458, 1423, 8024, 103, 103, 6498, 4851, 4125, 103, 2458, 6843, 5125, 5401, 2899, 816, 510, 1420, 7433, 185, 3727, 3302, 103, 2
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [7, 16, 17, 21, 34, 42, 47, 62, 78, 81, 82, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1062 3862 7030 4255 2015 6762 2897 2661 1187 3175 2544    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;在&#39;, &#39;街&#39;, &#39;上&#39;, &#39;听&#39;, &#39;见&#39;, &#39;音&#39;, &#39;乐&#39;, &#39;我&#39;, &#39;舞&#39;, &#39;动&#39;, &#39;起&#39;, &#39;来&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;？&#39;, &#39;真&#39;, &#39;的&#39;, &#39;很&#39;, &#39;丢&#39;, &#39;人&#39;, &#39;吗&#39;, &#39;？&#39;]
INFO:tensorflow:input_ids: [101, 103, 103, 677, 103, 6224, 7509, 727, 2769, 5659, 103, 6629, 3341, 2523, 696, 782, 8043, 4696, 4638, 2523, 696, 782, 1408, 8043, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [1, 2, 4, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1762 6125 1420 1220    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;三&#39;, &#39;毛&#39;, &#39;说&#39;, &#39;我&#39;, &#39;唯&#39;, &#39;一&#39;, &#39;锲&#39;, &#39;而&#39;, &#39;不&#39;, &#39;舍&#39;, &#39;，&#39;, &#39;愿&#39;, &#39;意&#39;, &#39;以&#39;, &#39;自&#39;, &#39;己&#39;, &#39;的&#39;, &#39;生&#39;, &#39;命&#39;, &#39;去&#39;, &#39;努&#39;, &#39;力&#39;, &#39;的&#39;, &#39;，&#39;, &#39;只&#39;, &#39;不&#39;, &#39;过&#39;, &#39;是&#39;, &#39;保&#39;, &#39;守&#39;, &#39;我&#39;, &#39;个&#39;, &#39;人&#39;, &#39;的&#39;, &#39;心&#39;, &#39;怀&#39;, &#39;意&#39;, &#39;念&#39;, &#39;，&#39;, &#39;在&#39;,
INFO:tensorflow:input_ids: [101, 676, 3688, 103, 2769, 1546, 671, 7244, 5445, 679, 5650, 8024, 2703, 2692, 103, 5632, 2346, 103, 4495, 1462, 1343, 1222, 1213, 4638, 8024, 103, 679, 6814, 3221, 103, 2127, 2769, 103, 782, 4638, 1
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [3, 14, 17, 25, 29, 32, 35, 39, 43, 47, 48, 54, 57, 59, 60, 63, 64, 66, 72, 0]
INFO:tensorflow:masked_lm_ids: [6432  809 4638 1372  924  702 2552 8024 4495  976  671 8024 2461 4495
 3833 4263 1469 4708 3198    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0]
INFO:tensorflow:[&#39;星&#39;, &#39;期&#39;, &#39;天&#39;, &#39;的&#39;, &#39;早&#39;, &#39;晨&#39;, &#39;七&#39;, &#39;点&#39;, &#39;学&#39;, &#39;车&#39;, &#39;，&#39;, &#39;驾&#39;, &#39;校&#39;, &#39;太&#39;, &#39;给&#39;, &#39;力&#39;, &#39;。&#39;, &#39;我&#39;, &#39;的&#39;, &#39;头&#39;, &#39;发&#39;, &#39;都&#39;, &#39;没&#39;, &#39;有&#39;, &#39;洗&#39;]
INFO:tensorflow:input_ids: [101, 3215, 3309, 1921, 4638, 3193, 3247, 673, 103, 103, 6756, 8024, 7730, 3413, 1922, 5314, 1213, 511, 2769, 4638, 1928, 1355, 6963, 3766, 3300, 3819, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [4157 2110    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;发&#39;, &#39;表&#39;, &#39;了&#39;, &#39;博&#39;, &#39;文&#39;, &#39;小&#39;, &#39;学&#39;, &#39;美&#39;, &#39;术&#39;, &#39;新&#39;, &#39;课&#39;, &#39;标&#39;, &#39;的&#39;, &#39;反&#39;, &#39;思&#39;, &#39;学&#39;, &#39;习&#39;, &#39;新&#39;, &#39;学&#39;, &#39;期&#39;, &#39;开&#39;, &#39;学&#39;, &#39;有&#39;, &#39;两&#39;, &#39;个&#39;, &#39;多&#39;, &#39;月&#39;, &#39;了&#39;, &#39;，&#39;, &#39;在&#39;, &#39;这&#39;, &#39;段&#39;, &#39;时&#39;, &#39;间&#39;, &#39;的&#39;, &#39;教&#39;, &#39;学&#39;, &#39;计&#39;, &#39;划&#39;, &#39;、&#39;,
INFO:tensorflow:input_ids: [101, 103, 6134, 749, 1300, 3152, 2207, 2110, 5401, 3318, 3173, 6440, 3403, 4638, 103, 2590, 2110, 739, 3173, 2110, 3309, 2458, 103, 3300, 697, 103, 103, 3299, 103, 8024, 1762, 6821, 3667, 3198, 7313,
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [1, 14, 22, 25, 26, 28, 35, 61, 71, 78, 81, 82, 88, 89, 90, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1355 1353 2110  702 1914  749 4638 1114 2769 3136 3418 2945 4157  809
 1350    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0]
INFO:tensorflow:[&#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;镰&#39;, &#39;刀&#39;, &#39;刮&#39;, &#39;腋&#39;, &#39;毛&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;我&#39;, &#39;的&#39;, &#39;朋&#39;, &#39;友&#39;, &#39;是&#39;, &#39;个&#39;, &#39;呆&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;哈&#39;, &#39;十&#39;, &#39;万&#39;, &#39;个&#39;,
INFO:tensorflow:input_ids: [101, 103, 1506, 1506, 1506, 103, 103, 7266, 1143, 1167, 5573, 103, 103, 1506, 1506, 1506, 1506, 1506, 2769, 4638, 3301, 103, 3221, 702, 1438, 103, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 1506, 1506
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
INFO:tensorflow:masked_lm_positions: [1, 5, 6, 11, 12, 21, 25, 35, 40, 42, 44, 54, 64, 66, 72, 77, 78, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [1506 1506 1506 3688 1506 1351 1506 1506  702 5010 2135 1506 1506 3345
 1506 4343 5513    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0]
INFO:tensorflow:[&#39;延&#39;, &#39;参&#39;, &#39;法&#39;, &#39;师&#39;, &#39;品&#39;, &#39;味&#39;, &#39;人&#39;, &#39;生&#39;, &#39;如&#39;, &#39;同&#39;, &#39;走&#39;, &#39;进&#39;, &#39;一&#39;, &#39;片&#39;, &#39;山&#39;, &#39;水&#39;, &#39;，&#39;, &#39;静&#39;, &#39;静&#39;, &#39;的&#39;, &#39;呼&#39;, &#39;吸&#39;, &#39;，&#39;, &#39;安&#39;, &#39;静&#39;, &#39;的&#39;, &#39;欣&#39;, &#39;赏&#39;, &#39;，&#39;, &#39;这&#39;, &#39;就&#39;, &#39;是&#39;, &#39;生&#39;, &#39;活&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 103, 1346, 3791, 2360, 1501, 1456, 782, 4495, 103, 1398, 6624, 6822, 671, 4275, 2255, 3717, 8024, 7474, 7474, 103, 1461, 1429, 8024, 2128, 7474, 103, 3615, 103, 8024, 6821, 2218, 3221, 4495, 383
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [1, 9, 20, 26, 28, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [2454 1963 4638 4638 6605    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:[&#39;就&#39;, &#39;感&#39;, &#39;恩&#39;, &#39;吧&#39;, &#39;越&#39;, &#39;来&#39;, &#39;越&#39;, &#39;没&#39;, &#39;战&#39;, &#39;斗&#39;, &#39;力&#39;, &#39;了&#39;, &#39;。&#39;]
INFO:tensorflow:input_ids: [101, 2218, 103, 2617, 1416, 6632, 3341, 6632, 3766, 2773, 3159, 1213, 749, 511, 102]
INFO:tensorflow:input_mask: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
INFO:tensorflow:segment_ids: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_positions: [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
INFO:tensorflow:masked_lm_ids: [2697    0    0    0    0    0    0    0    0    0    0    0    0    0
    0    0    0    0    0    0]
INFO:tensorflow:masked_lm_weights: [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
INFO:tensorflow:sampling weights: 
INFO:tensorflow:weibo_fake_cls_weibo_fake_ner: 0.4
INFO:tensorflow:weibo_fake_multi_cls: 0.2
INFO:tensorflow:weibo_masklm: 0.2
INFO:tensorflow:weibo_pretrain: 0.2
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Imports-and-utils">Imports and utils<a class="anchor-link" href="#Imports-and-utils"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="empty_tensor_handling_loss" class="doc_header"><code>empty_tensor_handling_loss</code><a href="https://github.com/JayYip/bert-multitask-learning/tree/master/bert_multitask_learning/top.py#L24" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>empty_tensor_handling_loss</code>(<strong><code>labels</code></strong>, <strong><code>logits</code></strong>, <strong><code>loss_fn</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nan_loss_handling" class="doc_header"><code>nan_loss_handling</code><a href="https://github.com/JayYip/bert-multitask-learning/tree/master/bert_multitask_learning/top.py#L37" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nan_loss_handling</code>(<strong><code>loss</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_dummy_if_empty" class="doc_header"><code>create_dummy_if_empty</code><a href="https://github.com/JayYip/bert-multitask-learning/tree/master/bert_multitask_learning/top.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_dummy_if_empty</code>(<strong><code>inp_tensor</code></strong>:<code>Tensor</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BaseTop" class="doc_header"><code>class</code> <code>BaseTop</code><a href="https://github.com/JayYip/bert-multitask-learning/tree/master/bert_multitask_learning/top.py#L59" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BaseTop</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>Model</code></p>
</blockquote>
<p><code>Model</code> groups layers into an object with training and inference features.</p>
<p>Arguments:
    inputs: The input(s) of the model: a <code>keras.Input</code> object or list of
        <code>keras.Input</code> objects.
    outputs: The output(s) of the model. See Functional API example below.
    name: String, the name of the model.</p>
<p>There are two ways to instantiate a <code>Model</code>:</p>
<p>1 - With the "Functional API", where you start from <code>Input</code>,
you chain layer calls to specify the model's forward pass,
and finally you create your model from inputs and outputs:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
<p>2 - By subclassing the <code>Model</code> class: in that case, you should define your
layers in <code>__init__</code> and you should implement the model's forward pass
in <code>call</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>If you subclass <code>Model</code>, you can optionally have
a <code>training</code> argument (boolean) in <code>call</code>, which you can use to specify
a different behavior in training and inference:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">training</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="n">training</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>Once the model is created, you can config the model with losses and metrics
with <code>model.compile()</code>, train the model with <code>model.fit()</code>, or use the model
to do prediction with <code>model.predict()</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sequence-Labeling">Sequence Labeling<a class="anchor-link" href="#Sequence-Labeling"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SequenceLabel" class="doc_header"><code>class</code> <code>SequenceLabel</code><a href="https://github.com/JayYip/bert-multitask-learning/tree/master/bert_multitask_learning/top.py#L70" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SequenceLabel</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>Model</code></p>
</blockquote>
<p><code>Model</code> groups layers into an object with training and inference features.</p>
<p>Arguments:
    inputs: The input(s) of the model: a <code>keras.Input</code> object or list of
        <code>keras.Input</code> objects.
    outputs: The output(s) of the model. See Functional API example below.
    name: String, the name of the model.</p>
<p>There are two ways to instantiate a <code>Model</code>:</p>
<p>1 - With the "Functional API", where you start from <code>Input</code>,
you chain layer calls to specify the model's forward pass,
and finally you create your model from inputs and outputs:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
<p>2 - By subclassing the <code>Model</code> class: in that case, you should define your
layers in <code>__init__</code> and you should implement the model's forward pass
in <code>call</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>If you subclass <code>Model</code>, you can optionally have
a <code>training</code> argument (boolean) in <code>call</code>, which you can use to specify
a different behavior in training and inference:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">training</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="n">training</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>Once the model is created, you can config the model with losses and metrics
with <code>model.compile()</code>, train the model with <code>model.fit()</code>, or use the model
to do prediction with <code>model.predict()</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_top_layer</span><span class="p">(</span><span class="n">SequenceLabel</span><span class="p">,</span> <span class="n">problem</span><span class="o">=</span><span class="s1">&#39;weibo_fake_ner&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">sample_features</span><span class="o">=</span><span class="n">one_batch</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">crf</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">test_top_layer</span><span class="p">(</span><span class="n">SequenceLabel</span><span class="p">,</span> <span class="n">problem</span><span class="o">=</span><span class="s1">&#39;weibo_fake_ner&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">sample_features</span><span class="o">=</span><span class="n">one_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing SequenceLabel
Testing SequenceLabel
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Classification">Classification<a class="anchor-link" href="#Classification"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Classification" class="doc_header"><code>class</code> <code>Classification</code><a href="https://github.com/JayYip/bert-multitask-learning/tree/master/bert_multitask_learning/top.py#L146" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Classification</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>Layer</code></p>
</blockquote>
<p>This is the class from which all layers inherit.</p>
<p>A layer is a callable object that takes as input one or more tensors and
that outputs one or more tensors. It involves <em>computation</em>, defined
in the <code>call()</code> method, and a <em>state</em> (weight variables), defined
either in the constructor <code>__init__()</code> or in the <code>build()</code> method.</p>
<p>Users will just instantiate a layer and then treat it as a callable.</p>
<p>Arguments:
  trainable: Boolean, whether the layer's variables should be trainable.
  name: String name of the layer.
  dtype: The dtype of the layer's computations and weights (default of
    <code>None</code> means use <code>tf.keras.backend.floatx</code> in TensorFlow 2, or the type
    of the first input in TensorFlow 1).
  dynamic: Set this to <code>True</code> if your layer should only be run eagerly, and
    should not be used to generate a static computation graph.
    This would be the case for a Tree-RNN or a recursive network,
    for example, or generally for any layer that manipulates tensors
    using Python control flow. If <code>False</code>, we assume that the layer can
    safely be used to generate a static computation graph.</p>
<p>Attributes:
  name: The name of the layer (string).
  dtype: The dtype of the layer's computations and weights. If mixed
    precision is used with a <code>tf.keras.mixed_precision.experimental.Policy</code>,
    this is instead just the dtype of the layer's weights, as the computations
    are done in a different dtype.
  trainable_weights: List of variables to be included in backprop.
  non_trainable_weights: List of variables that should not be
    included in backprop.
  weights: The concatenation of the lists trainable_weights and
    non_trainable_weights (in this order).
  trainable: Whether the layer should be trained (boolean), i.e. whether
    its potentially-trainable weights should be returned as part of
    <code>layer.trainable_weights</code>.
  input_spec: Optional (list of) <code>InputSpec</code> object(s) specifying the
    constraints on inputs that can be accepted by the layer.</p>
<p>We recommend that descendants of <code>Layer</code> implement the following methods:</p>
<ul>
<li><code>__init__()</code>: Defines custom layer attributes, and creates layer state
variables that do not depend on input shapes, using <code>add_weight()</code>.</li>
<li><code>build(self, input_shape)</code>: This method can be used to create weights that
depend on the shape(s) of the input(s), using <code>add_weight()</code>. <code>__call__()</code>
will automatically build the layer (if it has not been built yet) by
calling <code>build()</code>.</li>
<li><code>call(self, *args, **kwargs)</code>: Called in <code>__call__</code> after making sure
<code>build()</code> has been called. <code>call()</code> performs the logic of applying the
layer to the input tensors (which should be passed in as argument).
Two reserved keyword arguments you can optionally use in <code>call()</code> are:<ul>
<li><code>training</code> (boolean, whether the call is in
inference mode or training mode)</li>
<li><code>mask</code> (boolean tensor encoding masked timesteps in the input, used
in RNN layers)</li>
</ul>
</li>
<li><code>get_config(self)</code>: Returns a dictionary containing the configuration used
to initialize this layer. If the keys differ from the arguments
in <code>__init__</code>, then override <code>from_config(self)</code> as well.
This method is used when saving
the layer or a model that contains this layer.</li>
</ul>
<p>Examples:</p>
<p>Here's a basic example: a layer with two variables, <code>w</code> and <code>b</code>,
that returns <code>y = w . x + b</code>.
It shows how to implement <code>build()</code> and <code>call()</code>.
Variables set as attributes of a layer are tracked as weights
of the layers (in <code>layer.weights</code>).</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleDense</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">(</span><span class="n">SimpleDense</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>

  <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">):</span>  <span class="c1"># Create the state of the layer (weights)</span>
    <span class="n">w_init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">random_normal_initializer</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
        <span class="n">initial_value</span><span class="o">=</span><span class="n">w_init</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">),</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">),</span>
        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">b_init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros_initializer</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
        <span class="n">initial_value</span><span class="o">=</span><span class="n">b_init</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">),</span>
        <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>  <span class="c1"># Defines the computation from inputs to outputs</span>
      <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>

<span class="c1"># Instantiates the layer.</span>
<span class="n">linear_layer</span> <span class="o">=</span> <span class="n">SimpleDense</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># This will also call `build(input_shape)` and create the weights.</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">linear_layer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">linear_layer</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>

<span class="c1"># These weights are trainable, so they&#39;re listed in `trainable_weights`:</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">linear_layer</span><span class="o">.</span><span class="n">trainable_weights</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
<p>Note that the method <code>add_weight()</code> offers a shortcut to create weights:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleDense</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">(</span><span class="n">SimpleDense</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>

  <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">),</span>
                               <span class="n">initializer</span><span class="o">=</span><span class="s1">&#39;random_normal&#39;</span><span class="p">,</span>
                               <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,),</span>
                               <span class="n">initializer</span><span class="o">=</span><span class="s1">&#39;random_normal&#39;</span><span class="p">,</span>
                               <span class="n">trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
</pre></div>
<p>Besides trainable weights, updated via backpropagation during training,
layers can also have non-trainable weights. These weights are meant to
be updated manually during <code>call()</code>. Here's a example layer that computes
the running sum of its inputs:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ComputeSum</span><span class="p">(</span><span class="n">Layer</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">(</span><span class="n">ComputeSum</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
      <span class="c1"># Create a non-trainable weight.</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">initial_value</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">input_dim</span><span class="p">,)),</span>
                               <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="o">.</span><span class="n">assign_add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total</span>

<span class="n">my_sum</span> <span class="o">=</span> <span class="n">ComputeSum</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">my_sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>  <span class="c1"># [2. 2.]</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">my_sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>  <span class="c1"># [4. 4.]</span>

<span class="k">assert</span> <span class="n">my_sum</span><span class="o">.</span><span class="n">weights</span> <span class="o">==</span> <span class="p">[</span><span class="n">my_sum</span><span class="o">.</span><span class="n">total</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">my_sum</span><span class="o">.</span><span class="n">non_trainable_weights</span> <span class="o">==</span> <span class="p">[</span><span class="n">my_sum</span><span class="o">.</span><span class="n">total</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">my_sum</span><span class="o">.</span><span class="n">trainable_weights</span> <span class="o">==</span> <span class="p">[]</span>
</pre></div>
<p>For more information about creating layers, see the guide
<a href="https://www.tensorflow.org/guide/keras/custom_layers_and_models">Writing custom layers and models with Keras</a></p>
<p>About the layer's <code>dtype</code> attribute:</p>
<p>Each layer has a dtype, which is typically the dtype of the layer's
computations and variables. A layer's dtype can be queried via the
<code>Layer.dtype</code> property. The dtype is specified with the <code>dtype</code> constructor
argument. In TensorFlow 2, the dtype defaults to <code>tf.keras.backend.floatx()</code>
if no dtype is passed. <code>floatx()</code> itself defaults to "float32". Additionally,
layers will cast their inputs to the layer's dtype in TensorFlow 2. When mixed
precision is used, layers may have different computation and variable dtypes.
See <code>tf.keras.mixed_precision.experimental.Policy</code> for details on layer
dtypes.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_top_layer</span><span class="p">(</span><span class="n">Classification</span><span class="p">,</span> <span class="n">problem</span><span class="o">=</span><span class="s1">&#39;weibo_fake_cls&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">sample_features</span><span class="o">=</span><span class="n">one_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing Classification
WARNING:tensorflow:5 out of the last 12 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:6 out of the last 13 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:7 out of the last 14 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pretrain">Pretrain<a class="anchor-link" href="#Pretrain"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PreTrain" class="doc_header"><code>class</code> <code>PreTrain</code><a href="https://github.com/JayYip/bert-multitask-learning/tree/master/bert_multitask_learning/top.py#L190" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PreTrain</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>Model</code></p>
</blockquote>
<p><code>Model</code> groups layers into an object with training and inference features.</p>
<p>Arguments:
    inputs: The input(s) of the model: a <code>keras.Input</code> object or list of
        <code>keras.Input</code> objects.
    outputs: The output(s) of the model. See Functional API example below.
    name: String, the name of the model.</p>
<p>There are two ways to instantiate a <code>Model</code>:</p>
<p>1 - With the "Functional API", where you start from <code>Input</code>,
you chain layer calls to specify the model's forward pass,
and finally you create your model from inputs and outputs:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
<p>2 - By subclassing the <code>Model</code> class: in that case, you should define your
layers in <code>__init__</code> and you should implement the model's forward pass
in <code>call</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>If you subclass <code>Model</code>, you can optionally have
a <code>training</code> argument (boolean) in <code>call</code>, which you can use to specify
a different behavior in training and inference:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">training</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="n">training</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>Once the model is created, you can config the model with losses and metrics
with <code>model.compile()</code>, train the model with <code>model.fit()</code>, or use the model
to do prediction with <code>model.predict()</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_top_layer</span><span class="p">(</span><span class="n">PreTrain</span><span class="p">,</span> <span class="n">problem</span><span class="o">=</span><span class="s1">&#39;weibo_pretrain&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">sample_features</span><span class="o">=</span><span class="n">one_batch</span><span class="p">,</span> <span class="n">share_embedding</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing PreTrain
WARNING:tensorflow:8 out of the last 15 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:9 out of the last 16 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:10 out of the last 18 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:10 out of the last 11 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:10 out of the last 11 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:9 out of the last 11 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:9 out of the last 11 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:9 out of the last 11 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
WARNING:tensorflow:8 out of the last 11 calls to &lt;function empty_tensor_handling_loss at 0x7f1c80a9f160&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Seq2Seq">Seq2Seq<a class="anchor-link" href="#Seq2Seq"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Seq2Seq" class="doc_header"><code>class</code> <code>Seq2Seq</code><a href="https://github.com/JayYip/bert-multitask-learning/tree/master/bert_multitask_learning/top.py#L278" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Seq2Seq</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>Model</code></p>
</blockquote>
<p><code>Model</code> groups layers into an object with training and inference features.</p>
<p>Arguments:
    inputs: The input(s) of the model: a <code>keras.Input</code> object or list of
        <code>keras.Input</code> objects.
    outputs: The output(s) of the model. See Functional API example below.
    name: String, the name of the model.</p>
<p>There are two ways to instantiate a <code>Model</code>:</p>
<p>1 - With the "Functional API", where you start from <code>Input</code>,
you chain layer calls to specify the model's forward pass,
and finally you create your model from inputs and outputs:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
<p>2 - By subclassing the <code>Model</code> class: in that case, you should define your
layers in <code>__init__</code> and you should implement the model's forward pass
in <code>call</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>If you subclass <code>Model</code>, you can optionally have
a <code>training</code> argument (boolean) in <code>call</code>, which you can use to specify
a different behavior in training and inference:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">training</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="n">training</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>Once the model is created, you can config the model with losses and metrics
with <code>model.compile()</code>, train the model with <code>model.fit()</code>, or use the model
to do prediction with <code>model.predict()</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Multi-Label-Classification">Multi-Label Classification<a class="anchor-link" href="#Multi-Label-Classification"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiLabelClassification" class="doc_header"><code>class</code> <code>MultiLabelClassification</code><a href="https://github.com/JayYip/bert-multitask-learning/tree/master/bert_multitask_learning/top.py#L355" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiLabelClassification</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>Model</code></p>
</blockquote>
<p><code>Model</code> groups layers into an object with training and inference features.</p>
<p>Arguments:
    inputs: The input(s) of the model: a <code>keras.Input</code> object or list of
        <code>keras.Input</code> objects.
    outputs: The output(s) of the model. See Functional API example below.
    name: String, the name of the model.</p>
<p>There are two ways to instantiate a <code>Model</code>:</p>
<p>1 - With the "Functional API", where you start from <code>Input</code>,
you chain layer calls to specify the model's forward pass,
and finally you create your model from inputs and outputs:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
<p>2 - By subclassing the <code>Model</code> class: in that case, you should define your
layers in <code>__init__</code> and you should implement the model's forward pass
in <code>call</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>If you subclass <code>Model</code>, you can optionally have
a <code>training</code> argument (boolean) in <code>call</code>, which you can use to specify
a different behavior in training and inference:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">MyModel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">training</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="n">training</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>Once the model is created, you can config the model with losses and metrics
with <code>model.compile()</code>, train the model with <code>model.fit()</code>, or use the model
to do prediction with <code>model.predict()</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_top_layer</span><span class="p">(</span><span class="n">MultiLabelClassification</span><span class="p">,</span> <span class="n">problem</span><span class="o">=</span><span class="s1">&#39;weibo_fake_multi_cls&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">sample_features</span><span class="o">=</span><span class="n">one_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Testing MultiLabelClassification
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-14-124827cf23ed&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>test_top_layer<span class="ansi-blue-fg">(</span>MultiLabelClassification<span class="ansi-blue-fg">,</span> problem<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;weibo_fake_multi_cls&#39;</span><span class="ansi-blue-fg">,</span> params<span class="ansi-blue-fg">=</span>params<span class="ansi-blue-fg">,</span> sample_features<span class="ansi-blue-fg">=</span>one_batch<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-4-4efbf58bc7c7&gt;</span> in <span class="ansi-cyan-fg">test_top_layer</span><span class="ansi-blue-fg">(top_class, problem, params, sample_features, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     37</span>     <span class="ansi-red-fg"># non empty test</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span>     d_f<span class="ansi-blue-fg">,</span> d_h <span class="ansi-blue-fg">=</span> create_dummy_features_hidden_features<span class="ansi-blue-fg">(</span>batch_size<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> hidden_dim<span class="ansi-blue-fg">=</span>hidden_dim<span class="ansi-blue-fg">,</span> sample_features<span class="ansi-blue-fg">=</span>sample_features<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 39</span><span class="ansi-red-fg">     </span>_ <span class="ansi-blue-fg">=</span> top_layer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>d_f<span class="ansi-blue-fg">,</span> d_h<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">=</span>tf<span class="ansi-blue-fg">.</span>estimator<span class="ansi-blue-fg">.</span>ModeKeys<span class="ansi-blue-fg">.</span>TRAIN<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     40</span>     _ <span class="ansi-blue-fg">=</span> top_layer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>d_f<span class="ansi-blue-fg">,</span> d_h<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">=</span>tf<span class="ansi-blue-fg">.</span>estimator<span class="ansi-blue-fg">.</span>ModeKeys<span class="ansi-blue-fg">.</span>EVAL<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     41</span>     _ <span class="ansi-blue-fg">=</span> top_layer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>d_f<span class="ansi-blue-fg">,</span> d_h<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> mode<span class="ansi-blue-fg">=</span>tf<span class="ansi-blue-fg">.</span>estimator<span class="ansi-blue-fg">.</span>ModeKeys<span class="ansi-blue-fg">.</span>PREDICT<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/data/anaconda3/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    983</span> 
<span class="ansi-green-intense-fg ansi-bold">    984</span>         <span class="ansi-green-fg">with</span> ops<span class="ansi-blue-fg">.</span>enable_auto_cast_variables<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_compute_dtype_object<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 985</span><span class="ansi-red-fg">           </span>outputs <span class="ansi-blue-fg">=</span> call_fn<span class="ansi-blue-fg">(</span>inputs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    986</span> 
<span class="ansi-green-intense-fg ansi-bold">    987</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_activity_regularizer<span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">&lt;ipython-input-13-4e01bac31e1d&gt;</span> in <span class="ansi-cyan-fg">call</span><span class="ansi-blue-fg">(self, inputs, mode)</span>
<span class="ansi-green-intense-fg ansi-bold">     35</span>             <span class="ansi-green-fg">def</span> _loss_fn_wrapper<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">,</span> from_logits<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     36</span>                 <span class="ansi-green-fg">return</span> tf<span class="ansi-blue-fg">.</span>nn<span class="ansi-blue-fg">.</span>weighted_cross_entropy_with_logits<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span> y<span class="ansi-blue-fg">,</span> pos_weight<span class="ansi-blue-fg">=</span>label_weights<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;{}_loss&#39;</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>problem_name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 37</span><span class="ansi-red-fg">             loss = empty_tensor_handling_loss(
</span><span class="ansi-green-intense-fg ansi-bold">     38</span>                 labels, logits, _loss_fn_wrapper)
<span class="ansi-green-intense-fg ansi-bold">     39</span>             loss <span class="ansi-blue-fg">=</span> nan_loss_handling<span class="ansi-blue-fg">(</span>loss<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/data/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    778</span>       <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    779</span>         compiler <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#34;nonXla&#34;</span>
<span class="ansi-green-fg">--&gt; 780</span><span class="ansi-red-fg">         </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_call<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    781</span> 
<span class="ansi-green-intense-fg ansi-bold">    782</span>       new_tracing_count <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_get_tracing_count<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/data/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py</span> in <span class="ansi-cyan-fg">_call</span><span class="ansi-blue-fg">(self, *args, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    812</span>       <span class="ansi-red-fg"># In this case we have not created variables on the first call. So we can</span>
<span class="ansi-green-intense-fg ansi-bold">    813</span>       <span class="ansi-red-fg"># run the first trace but we should fail if variables are created.</span>
<span class="ansi-green-fg">--&gt; 814</span><span class="ansi-red-fg">       </span>results <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_stateful_fn<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    815</span>       <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_created_variables<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    816</span>         raise ValueError(&#34;Creating variables on a non-first call to a function&#34;

<span class="ansi-green-fg">/data/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   2826</span>     <span class="ansi-blue-fg">&#34;&#34;&#34;Calls a graph function specialized to the inputs.&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   2827</span>     <span class="ansi-green-fg">with</span> self<span class="ansi-blue-fg">.</span>_lock<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">-&gt; 2828</span><span class="ansi-red-fg">       </span>graph_function<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">,</span> kwargs <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_maybe_define_function<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">,</span> kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   2829</span>     <span class="ansi-green-fg">return</span> graph_function<span class="ansi-blue-fg">.</span>_filtered_call<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">,</span> kwargs<span class="ansi-blue-fg">)</span>  <span class="ansi-red-fg"># pylint: disable=protected-access</span>
<span class="ansi-green-intense-fg ansi-bold">   2830</span> 

<span class="ansi-green-fg">/data/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py</span> in <span class="ansi-cyan-fg">_maybe_define_function</span><span class="ansi-blue-fg">(self, args, kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">   3211</span> 
<span class="ansi-green-intense-fg ansi-bold">   3212</span>       self<span class="ansi-blue-fg">.</span>_function_cache<span class="ansi-blue-fg">.</span>missed<span class="ansi-blue-fg">.</span>add<span class="ansi-blue-fg">(</span>call_context_key<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">-&gt; 3213</span><span class="ansi-red-fg">       </span>graph_function <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_create_graph_function<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">,</span> kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   3214</span>       self<span class="ansi-blue-fg">.</span>_function_cache<span class="ansi-blue-fg">.</span>primary<span class="ansi-blue-fg">[</span>cache_key<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> graph_function
<span class="ansi-green-intense-fg ansi-bold">   3215</span>       <span class="ansi-green-fg">return</span> graph_function<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">,</span> kwargs

<span class="ansi-green-fg">/data/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py</span> in <span class="ansi-cyan-fg">_create_graph_function</span><span class="ansi-blue-fg">(self, args, kwargs, override_flat_arg_shapes)</span>
<span class="ansi-green-intense-fg ansi-bold">   3063</span>     arg_names <span class="ansi-blue-fg">=</span> base_arg_names <span class="ansi-blue-fg">+</span> missing_arg_names
<span class="ansi-green-intense-fg ansi-bold">   3064</span>     graph_function = ConcreteFunction(
<span class="ansi-green-fg">-&gt; 3065</span><span class="ansi-red-fg">         func_graph_module.func_graph_from_py_func(
</span><span class="ansi-green-intense-fg ansi-bold">   3066</span>             self<span class="ansi-blue-fg">.</span>_name<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   3067</span>             self<span class="ansi-blue-fg">.</span>_python_function<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/data/anaconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py</span> in <span class="ansi-cyan-fg">func_graph_from_py_func</span><span class="ansi-blue-fg">(name, python_func, args, kwargs, signature, func_graph, autograph, autograph_options, add_control_dependencies, arg_names, op_return_value, collections, capture_by_value, override_flat_arg_shapes)</span>
<span class="ansi-green-intense-fg ansi-bold">    984</span>         _<span class="ansi-blue-fg">,</span> original_func <span class="ansi-blue-fg">=</span> tf_decorator<span class="ansi-blue-fg">.</span>unwrap<span class="ansi-blue-fg">(</span>python_func<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    985</span> 
<span class="ansi-green-fg">--&gt; 986</span><span class="ansi-red-fg">       </span>func_outputs <span class="ansi-blue-fg">=</span> python_func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>func_args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>func_kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    987</span> 
<span class="ansi-green-intense-fg ansi-bold">    988</span>       <span class="ansi-red-fg"># invariant: `func_outputs` contains only Tensors, CompositeTensors,</span>

<span class="ansi-green-fg">/data/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py</span> in <span class="ansi-cyan-fg">wrapped_fn</span><span class="ansi-blue-fg">(*args, **kwds)</span>
<span class="ansi-green-intense-fg ansi-bold">    598</span>         <span class="ansi-red-fg"># __wrapped__ allows AutoGraph to swap in a converted function. We give</span>
<span class="ansi-green-intense-fg ansi-bold">    599</span>         <span class="ansi-red-fg"># the function a weak reference to itself to avoid a reference cycle.</span>
<span class="ansi-green-fg">--&gt; 600</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> weak_wrapped_fn<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__wrapped__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwds<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    601</span>     weak_wrapped_fn <span class="ansi-blue-fg">=</span> weakref<span class="ansi-blue-fg">.</span>ref<span class="ansi-blue-fg">(</span>wrapped_fn<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    602</span> 

<span class="ansi-green-fg">/data/anaconda3/lib/python3.8/site-packages/tensorflow/python/framework/func_graph.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    971</span>           <span class="ansi-green-fg">except</span> Exception <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># pylint:disable=broad-except</span>
<span class="ansi-green-intense-fg ansi-bold">    972</span>             <span class="ansi-green-fg">if</span> hasattr<span class="ansi-blue-fg">(</span>e<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;ag_error_metadata&#34;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 973</span><span class="ansi-red-fg">               </span><span class="ansi-green-fg">raise</span> e<span class="ansi-blue-fg">.</span>ag_error_metadata<span class="ansi-blue-fg">.</span>to_exception<span class="ansi-blue-fg">(</span>e<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    974</span>             <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    975</span>               <span class="ansi-green-fg">raise</span>

<span class="ansi-red-fg">ValueError</span>: in user code:

    &lt;ipython-input-5-b08c02051d86&gt;:29 empty_tensor_handling_loss  *
        labels, logits, from_logits=True))
    &lt;ipython-input-13-4e01bac31e1d&gt;:36 _loss_fn_wrapper  *
        return tf.nn.weighted_cross_entropy_with_logits(x, y, pos_weight=label_weights, name=&#39;{}_loss&#39;.format(self.problem_name))
    /data/anaconda3/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201 wrapper  **
        return target(*args, **kwargs)
    /data/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/nn_impl.py:309 weighted_cross_entropy_with_logits_v2
        raise ValueError(&#34;logits and labels must have the same shape (%s vs %s)&#34; %

    ValueError: logits and labels must have the same shape ((1, 3) vs (1, 1))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mask-LM">Mask LM<a class="anchor-link" href="#Mask-LM"> </a></h2><p>Mask LM top layer</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MaskLM" class="doc_header"><code>class</code> <code>MaskLM</code><a href="https://github.com/JayYip/bert-multitask-learning/tree/master/bert_multitask_learning/top.py#L405" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MaskLM</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>Model</code></p>
</blockquote>
<p>Multimodal MLM top layer.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered celltag_outputPrepend">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_top_layer</span><span class="p">(</span><span class="n">MaskLM</span><span class="p">,</span> <span class="n">problem</span><span class="o">=</span><span class="s1">&#39;weibo_masklm&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">sample_features</span><span class="o">=</span><span class="n">one_batch</span><span class="p">,</span> <span class="n">share_embedding</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

