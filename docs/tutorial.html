---

title: Tutorial


keywords: fastai
sidebar: home_sidebar



nb_path: "source_nbs/tutorial.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: source_nbs/tutorial.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Minimal-Example">Minimal Example<a class="anchor-link" href="#Minimal-Example"> </a></h2><p>In this example, we'll create train, eval and predict toy problems. But first, we need to what dose problem mean here. Essentially, a problem should have <strong>a name(string), a problem type(string), and a preprocessing function(callable)</strong>. The following problem type is pre-defined:</p>
<ul>
<li><code>cls</code>: classification</li>
<li><code>seq_tag</code>: sequence labeling</li>
<li><code>multi_cls</code>: multi-label classification</li>
<li><code>mask_lm</code>: masked language model</li>
<li><code>pretrain</code>: masked lm + next sentence prediction</li>
</ul>
<p>Normally, you would want to use this library to do multi-task learning. There are two types of chaining operations can be used to chain problems.</p>
<ul>
<li><code>&amp;</code>. If two problems have the same inputs, they can be chained using <code>&amp;</code>. Problems chained by <code>&amp;</code> will be trained at the same time.</li>
<li><code>|</code>. If two problems don't have the same inputs, they need to be chained using <code>|</code>. Problems chained by <code>|</code> will be sampled to train at every instance.</li>
</ul>
<p>If your problem dose not fall in the pre-defined problem types, you can implement your own and register to params. We will cover this topic later. Let's start with a simple example of adding a classification problem and a sequence labeling problem.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">problem_type_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;toy_cls&#39;</span><span class="p">:</span> <span class="s1">&#39;cls&#39;</span><span class="p">,</span> <span class="s1">&#39;toy_seq_tag&#39;</span><span class="p">:</span> <span class="s1">&#39;seq_tag&#39;</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we need to do some coding. We need to implement preprocessing function for each problem. The preprocessing function is a callable with</p>
<ul>
<li>same name as problem name</li>
<li>fixed input signature </li>
<li>returns(or yield) inputs and targets</li>
<li>decorated by <code>bert_multitask_learning.preproc_decorator.preprocessing_fn</code></li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">bert_multitask_learning</span>
<span class="kn">from</span> <span class="nn">bert_multitask_learning.preproc_decorator</span> <span class="kn">import</span> <span class="n">preprocessing_fn</span>
<span class="kn">from</span> <span class="nn">bert_multitask_learning.params</span> <span class="kn">import</span> <span class="n">BaseParams</span>
<span class="nd">@preprocessing_fn</span>
<span class="k">def</span> <span class="nf">toy_cls</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">BaseParams</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s2">&quot;Simple example to demonstrate singe modal tuple of list return&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;this is a test&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;this is a test&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">toy_input</span><span class="p">,</span> <span class="n">toy_target</span>

<span class="nd">@preprocessing_fn</span>
<span class="k">def</span> <span class="nf">toy_seq_tag</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">BaseParams</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s2">&quot;Simple example to demonstrate singe modal tuple of list return&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;this is a test&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;this is a test&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">toy_input</span><span class="p">,</span> <span class="n">toy_target</span>

<span class="n">processing_fn_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;toy_cls&#39;</span><span class="p">:</span> <span class="n">toy_cls</span><span class="p">,</span> <span class="s1">&#39;toy_seq_tag&#39;</span><span class="p">:</span> <span class="n">toy_seq_tag</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we're good to go! Since these two toy problems shares the same input, we can chain them with <code>&amp;</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">bert_multitask_learning</span> <span class="kn">import</span> <span class="n">train_bert_multitask</span><span class="p">,</span> <span class="n">eval_bert_multitask</span><span class="p">,</span> <span class="n">predict_bert_multitask</span>
<span class="n">problem</span> <span class="o">=</span> <span class="s1">&#39;toy_cls&amp;toy_seq_tag&#39;</span>
<span class="c1"># train</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">train_bert_multitask</span><span class="p">(</span>
    <span class="n">problem</span><span class="o">=</span><span class="n">problem</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">problem_type_dict</span><span class="o">=</span><span class="n">problem_type_dict</span><span class="p">,</span>
    <span class="n">processing_fn_dict</span><span class="o">=</span><span class="n">processing_fn_dict</span><span class="p">,</span>
    <span class="n">continue_training</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary data-open="Hide Output" data-close="Show Output"></summary>
        <summary></summary>
        
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>WARNING:root:bert_config not exists. will load model from huggingface checkpoint.
Adding new problem toy_cls, problem type: cls
Adding new problem toy_seq_tag, problem type: seq_tag
INFO:tensorflow:sampling weights: 
INFO:tensorflow:toy_cls_toy_seq_tag: 1.0
INFO:tensorflow:sampling weights: 
INFO:tensorflow:toy_cls_toy_seq_tag: 1.0
INFO:tensorflow:sampling weights: 
INFO:tensorflow:toy_cls_toy_seq_tag: 1.0
WARNING:tensorflow:There are non-GPU devices in `tf.distribute.Strategy`, not using nccl allreduce.
INFO:tensorflow:Using MirroredStrategy with devices (&#39;/job:localhost/replica:0/task:0/device:CPU:0&#39;,)
Some layers from the model checkpoint at bert-base-chinese were not used when initializing TFBertModel: [&#39;mlm___cls&#39;, &#39;nsp___cls&#39;]
- This IS expected if you are initializing TFBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing TFBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
All the layers of TFBertModel were initialized from the model checkpoint at bert-base-chinese.
If your task is similar to the task the model of the checkpoint was trained on, you can already use TFBertModel for predictions without further training.
WARNING:tensorflow:From /data/anaconda3/lib/python3.8/inspect.py:350: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
WARNING:tensorflow:From /data/anaconda3/lib/python3.8/inspect.py:350: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
INFO:tensorflow:Initial lr: 2e-05
INFO:tensorflow:Train steps: 1
INFO:tensorflow:Warmup steps: 0
WARNING:tensorflow:From /data/anaconda3/lib/python3.8/site-packages/tensorflow/python/data/ops/multi_device_iterator_ops.py:601: get_next_as_optional (from tensorflow.python.data.ops.iterator_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Iterator.get_next_as_optional()` instead.
WARNING:tensorflow:AutoGraph could not transform &lt;bound method Socket.send of &lt;zmq.sugar.socket.Socket object at 0x7f071c6a6940&gt;&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: module, class, method, function, traceback, frame, or code object was expected, got cython_function_or_method
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING: AutoGraph could not transform &lt;bound method Socket.send of &lt;zmq.sugar.socket.Socket object at 0x7f071c6a6940&gt;&gt; and will run it as-is.
Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.
Cause: module, class, method, function, traceback, frame, or code object was expected, got cython_function_or_method
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
The parameters `output_attentions`, `output_hidden_states` and `use_cache` cannot be updated when calling a model.They have to be set to True/False in the config object (i.e.: `config=XConfig.from_pretrained(&#39;name&#39;, output_attentions=True)`).
The parameter `return_dict` cannot be set in graph mode and will always be set to `True`.
The parameters `output_attentions`, `output_hidden_states` and `use_cache` cannot be updated when calling a model.They have to be set to True/False in the config object (i.e.: `config=XConfig.from_pretrained(&#39;name&#39;, output_attentions=True)`).
The parameter `return_dict` cannot be set in graph mode and will always be set to `True`.
The parameters `output_attentions`, `output_hidden_states` and `use_cache` cannot be updated when calling a model.They have to be set to True/False in the config object (i.e.: `config=XConfig.from_pretrained(&#39;name&#39;, output_attentions=True)`).
The parameter `return_dict` cannot be set in graph mode and will always be set to `True`.
The parameters `output_attentions`, `output_hidden_states` and `use_cache` cannot be updated when calling a model.They have to be set to True/False in the config object (i.e.: `config=XConfig.from_pretrained(&#39;name&#39;, output_attentions=True)`).
The parameter `return_dict` cannot be set in graph mode and will always be set to `True`.
1/1 [==============================] - ETA: 0s - mean_acc: 0.3000 - toy_cls_acc: 0.3000 - toy_seq_tag_acc: 0.3000 - toy_cls_loss: 0.8341 - toy_seq_tag_loss: 2.0840The parameters `output_attentions`, `output_hidden_states` and `use_cache` cannot be updated when calling a model.They have to be set to True/False in the config object (i.e.: `config=XConfig.from_pretrained(&#39;name&#39;, output_attentions=True)`).
The parameter `return_dict` cannot be set in graph mode and will always be set to `True`.
The parameters `output_attentions`, `output_hidden_states` and `use_cache` cannot be updated when calling a model.They have to be set to True/False in the config object (i.e.: `config=XConfig.from_pretrained(&#39;name&#39;, output_attentions=True)`).
The parameter `return_dict` cannot be set in graph mode and will always be set to `True`.
1/1 [==============================] - 7s 7s/step - mean_acc: 0.3000 - toy_cls_acc: 0.3000 - toy_seq_tag_acc: 0.3000 - toy_cls_loss: 0.8341 - toy_seq_tag_loss: 2.0840 - val_loss: 2.7318 - val_mean_acc: 0.3833 - val_toy_cls_acc: 0.6000 - val_toy_seq_tag_acc: 0.1667
Model: &#34;BertMultiTask&#34;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
BertMultiTaskBody (BertMulti multiple                  102267648 
_________________________________________________________________
BertMultiTaskTop (BertMultiT multiple                  5387      
_________________________________________________________________
mean_acc (Mean)              multiple                  2         
=================================================================
Total params: 102,273,037
Trainable params: 102,273,031
Non-trainable params: 6
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

    </details>
</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For eval, we can need to provide <code>model_dir</code> or <code>model</code> to the function.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered celltag_outputPrepend">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># eval</span>
<span class="n">eval_dict</span> <span class="o">=</span> <span class="n">eval_bert_multitask</span><span class="p">(</span><span class="n">problem</span><span class="o">=</span><span class="n">problem</span><span class="p">,</span>
                    <span class="n">problem_type_dict</span><span class="o">=</span><span class="n">problem_type_dict</span><span class="p">,</span> <span class="n">processing_fn_dict</span><span class="o">=</span><span class="n">processing_fn_dict</span><span class="p">,</span>
                    <span class="n">model_dir</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">ckpt_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;loss&#39;: 2.7317519187927246, &#39;mean_acc&#39;: 0.38333335518836975, &#39;toy_cls_acc&#39;: 0.6000000238418579, &#39;toy_seq_tag_acc&#39;: 0.1666666716337204}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># predict</span>
<span class="n">fake_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;this is a test&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">pred</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="n">predict_bert_multitask</span><span class="p">(</span>
    <span class="n">problem</span><span class="o">=</span><span class="n">problem</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">fake_inputs</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">ckpt_dir</span><span class="p">,</span>
    <span class="n">problem_type_dict</span><span class="o">=</span><span class="n">problem_type_dict</span><span class="p">,</span>
    <span class="n">processing_fn_dict</span><span class="o">=</span><span class="n">processing_fn_dict</span><span class="p">,</span> <span class="n">return_model</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pred</code> is a dictionary with problem name as key and probability distribution array as value.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">problem_name</span><span class="p">,</span> <span class="n">prob_array</span> <span class="ow">in</span> <span class="n">pred</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">problem_name</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">prob_array</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>toy_cls - (10, 2)
toy_seq_tag - (10, 6, 5)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Use-Different-Models">Use Different Models<a class="anchor-link" href="#Use-Different-Models"> </a></h2><p>By default, we use Bert as the base model. But thanks to transformers, it's easy to switch to any SOTA transformers models with some simple configuration and pass the params to train function as an argument.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered celltag_outputPrepend">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># change model to distilbert-base-uncased</span>
<span class="kn">from</span> <span class="nn">bert_multitask_learning.params</span> <span class="kn">import</span> <span class="n">BaseParams</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">BaseParams</span><span class="p">()</span>
<span class="c1"># specify model and its loading module</span>
<span class="n">params</span><span class="o">.</span><span class="n">transformer_model_name</span> <span class="o">=</span> <span class="s1">&#39;distilbert-base-uncased&#39;</span>
<span class="n">params</span><span class="o">.</span><span class="n">transformer_model_loading</span> <span class="o">=</span> <span class="s1">&#39;TFDistilBertModel&#39;</span>
<span class="c1"># specify tokenizer and its loading module</span>
<span class="n">params</span><span class="o">.</span><span class="n">transformer_tokenizer_name</span> <span class="o">=</span> <span class="s1">&#39;distilbert-base-uncased&#39;</span>
<span class="n">params</span><span class="o">.</span><span class="n">transformer_tokenizer_loading</span> <span class="o">=</span> <span class="s1">&#39;DistilBertTokenizer&#39;</span>
<span class="c1"># specify config and its loading module</span>
<span class="n">params</span><span class="o">.</span><span class="n">transformer_config_name</span> <span class="o">=</span> <span class="s1">&#39;distilbert-base-uncased&#39;</span>
<span class="n">params</span><span class="o">.</span><span class="n">transformer_config_loading</span> <span class="o">=</span> <span class="s1">&#39;DistilBertConfig&#39;</span>

<span class="c1"># train model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">train_bert_multitask</span><span class="p">(</span>
    <span class="n">problem</span><span class="o">=</span><span class="n">problem</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">problem_type_dict</span><span class="o">=</span><span class="n">problem_type_dict</span><span class="p">,</span>
    <span class="n">processing_fn_dict</span><span class="o">=</span><span class="n">processing_fn_dict</span><span class="p">,</span>
    <span class="n">continue_training</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="n">params</span> <span class="c1"># pass params</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Write-More-Flexible-Preprocessing-Function">Write More Flexible Preprocessing Function<a class="anchor-link" href="#Write-More-Flexible-Preprocessing-Function"> </a></h2><p>The preprocessing function should return two elements: inputs and targets, except for <code>pretrain</code> problem type. You don't need to manually tokenize your inputs and encode the targets, it will be done automatically.</p>
<p>For features and targets, it can be one of the following format:</p>
<ul>
<li>tuple of list. This is the way to go if your data can fit into memory.</li>
<li>generator of tuple. You should use generator if your data cannot fit into memory.</li>
</ul>
<p>The features can be single modal and multi-modal. We will elaborate each form of the input in this section.</p>
<p>Please note that if preprocessing function returns generator of tuple, then corresponding problem cannot be chained using <code>&amp;</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Single-Modal-Input">Single Modal Input<a class="anchor-link" href="#Single-Modal-Input"> </a></h3><h4 id="Tuple-of-list">Tuple of list<a class="anchor-link" href="#Tuple-of-list"> </a></h4><p>Normal text, label pair</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@preprocessing_fn</span>
<span class="k">def</span> <span class="nf">toy_cls</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">BaseParams</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s2">&quot;Simple example to demonstrate singe modal tuple of list return&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;this is a test&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;this is a test&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">toy_input</span><span class="p">,</span> <span class="n">toy_target</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A, B tokens</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@preprocessing_fn</span>
<span class="k">def</span> <span class="nf">toy_cls</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">BaseParams</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s2">&quot;Simple example to demonstrate singe modal tuple of list return&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;this is a test&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;this is a test&#39;</span><span class="p">}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;this is a test&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;this is a test&#39;</span><span class="p">}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">toy_input</span><span class="p">,</span> <span class="n">toy_target</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Generator-of-tuple">Generator of tuple<a class="anchor-link" href="#Generator-of-tuple"> </a></h4><p>Normal text, label pair</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@preprocessing_fn</span>
<span class="k">def</span> <span class="nf">toy_cls</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">BaseParams</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s2">&quot;Simple example to demonstrate singe modal tuple of list return&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;this is a test&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;this is a test&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">single_input</span><span class="p">,</span> <span class="n">single_target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">toy_input</span><span class="p">,</span> <span class="n">toy_target</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">single_input</span><span class="p">,</span> <span class="n">single_target</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A, B tokens. Same, skipped.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multi-modal-Input">Multi-modal Input<a class="anchor-link" href="#Multi-modal-Input"> </a></h3><p>The other modal should be passed as an array.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Tuple-of-list">Tuple of list<a class="anchor-link" href="#Tuple-of-list"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@preprocessing_fn</span>
<span class="k">def</span> <span class="nf">toy_cls</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">BaseParams</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s2">&quot;Simple example to demonstrate multi-modal tuple of list return&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;this is a test&#39;</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">))}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;this is a test&#39;</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">))}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    
    <span class="k">return</span> <span class="n">toy_input</span><span class="p">,</span> <span class="n">toy_target</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Generator-of-tuple">Generator of tuple<a class="anchor-link" href="#Generator-of-tuple"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@preprocessing_fn</span>
<span class="k">def</span> <span class="nf">toy_cls</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">BaseParams</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="s2">&quot;Simple example to demonstrate multi-modal tuple of list return&quot;</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">bert_multitask_learning</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;this is a test&#39;</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">))}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">toy_input</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;this is a test&#39;</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">))}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">toy_target</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;b&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    
    <span class="k">for</span> <span class="n">single_input</span><span class="p">,</span> <span class="n">single_target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">toy_input</span><span class="p">,</span> <span class="n">toy_target</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">single_input</span><span class="p">,</span> <span class="n">single_target</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note: A, B token of multi-modal input is not working yet!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-Happened?">What Happened?<a class="anchor-link" href="#What-Happened?"> </a></h3><p>The inputs returned by preprocessing function will be tokenized using transformers tokenizer which is configurable like we showed before and the labels will be encoded(or tokenized if the target is text) as scalar or numpy array. The encoded inputs and target then will be serialized and written as TFRecord. Please note that the TFRecord will NOT be overwritten even if you run the code again. So if you want to change the data in TFRecord, you need to manually remove the directory of TFRecord. The default directory is <code>./tmp/{problem_name}</code>.</p>
<p>After the TFRecord is created, if you want to check the feature info, you can head to the corresponding directory and take a look at the json file within.</p>
<p>First, we make sure the TFRecord is created.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">bert_multitask_learning.input_fn</span> <span class="kn">import</span> <span class="n">train_eval_input_fn</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">train_eval_input_fn</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>INFO:tensorflow:sampling weights: 
INFO:tensorflow:toy_cls_toy_seq_tag: 1.0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can take a look at the json file.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># the problem chained by &amp; create one TFRecord folder</span>
<span class="n">json_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">tmp_file_dir</span><span class="p">,</span> <span class="s1">&#39;toy_cls_toy_seq_tag&#39;</span><span class="p">,</span> <span class="s1">&#39;train_feature_desc.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">json_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{
    &#34;input_ids&#34;: &#34;int64&#34;,
    &#34;input_ids_shape_value&#34;: [
        null
    ],
    &#34;input_ids_shape&#34;: &#34;int64&#34;,
    &#34;input_mask&#34;: &#34;int64&#34;,
    &#34;input_mask_shape_value&#34;: [
        null
    ],
    &#34;input_mask_shape&#34;: &#34;int64&#34;,
    &#34;segment_ids&#34;: &#34;int64&#34;,
    &#34;segment_ids_shape_value&#34;: [
        null
    ],
    &#34;segment_ids_shape&#34;: &#34;int64&#34;,
    &#34;toy_cls_label_ids&#34;: &#34;int64&#34;,
    &#34;toy_cls_label_ids_shape&#34;: &#34;int64&#34;,
    &#34;toy_cls_label_ids_shape_value&#34;: [],
    &#34;toy_seq_tag_label_ids&#34;: &#34;int64&#34;,
    &#34;toy_seq_tag_label_ids_shape_value&#34;: [
        null
    ],
    &#34;toy_seq_tag_label_ids_shape&#34;: &#34;int64&#34;
}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

